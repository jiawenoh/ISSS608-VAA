<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oh Jia Wen">
<meta name="dcterms.date" content="2023-05-16">

<title>Take Home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Take-Home_Ex/Take_Home_Ex01/Take-Home_Ex01.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
<link href="../../site_libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Take Home Exercise 2</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Welcome</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://isss608-ohjiawen.netlify.app/" title="" class="sidebar-tool px-1"><i class="bi bi-house-fill"></i></a>
    <a href="https://github.com/jiawenoh/ISSS608-VAA" title="" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/jia-wen-oh/" title="" class="sidebar-tool px-1"><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">About</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about_me.html" class="sidebar-item-text sidebar-link">About Me</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Hands-on Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 6 Part One</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex06/Hands_on_Ex06_PartTwo.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 6 Part Two</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">In-class Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" class="sidebar-item-text sidebar-link">In-class Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" class="sidebar-item-text sidebar-link">In-class Exercise 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" class="sidebar-item-text sidebar-link">In-class Exercise 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" class="sidebar-item-text sidebar-link">In-class Exercise 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" class="sidebar-item-text sidebar-link">In-class Exercise 6</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Take Home Exercise</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take_Home_Ex01/Take-Home_Ex01.html" class="sidebar-item-text sidebar-link">Take Home Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take_Home_Ex02/Take-Home_Ex02.html" class="sidebar-item-text sidebar-link active">Take Home Exercise 2</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. OVERVIEW</a>
  <ul class="collapse">
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task">1.1 The Task</a></li>
  </ul></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets">2. Datasets</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3. Data Preparation</a>
  <ul class="collapse">
  <li><a href="#install-r-packages" id="toc-install-r-packages" class="nav-link" data-scroll-target="#install-r-packages">3.1 Install R-packages</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data">3.2 Importing Data</a></li>
  <li><a href="#create-tibble-dataframe" id="toc-create-tibble-dataframe" class="nav-link" data-scroll-target="#create-tibble-dataframe">3.3 Create Tibble Dataframe</a></li>
  <li><a href="#concatenate-tibble-dataframe" id="toc-concatenate-tibble-dataframe" class="nav-link" data-scroll-target="#concatenate-tibble-dataframe">3.4 Concatenate Tibble Dataframe</a></li>
  <li><a href="#creating-a-master-id-data-frame" id="toc-creating-a-master-id-data-frame" class="nav-link" data-scroll-target="#creating-a-master-id-data-frame">Creating a Master ID data frame</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3.5 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#top-30-source-and-top-30-target" id="toc-top-30-source-and-top-30-target" class="nav-link" data-scroll-target="#top-30-source-and-top-30-target">TOP 30 SOURCE AND TOP 30 TARGET</a></li>
  <li><a href="#create-network-graph-for-fishes" id="toc-create-network-graph-for-fishes" class="nav-link" data-scroll-target="#create-network-graph-for-fishes">create network graph for fishes</a></li>
  </ul></li>
  <li><a href="#data-preparation-for-visnetwork" id="toc-data-preparation-for-visnetwork" class="nav-link" data-scroll-target="#data-preparation-for-visnetwork">Data Preparation for visNetwork</a></li>
  <li><a href="#filter-unknown-status" id="toc-filter-unknown-status" class="nav-link" data-scroll-target="#filter-unknown-status">filter unknown status</a></li>
  </ul></li>
  <li><a href="#filter-for-companies-with-duplicated-entries" id="toc-filter-for-companies-with-duplicated-entries" class="nav-link" data-scroll-target="#filter-for-companies-with-duplicated-entries">filter for companies with duplicated entries</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Take Home Exercise 2</h1>
<p class="subtitle lead">Mini Case 2 of Vast Challenge 2023</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Oh Jia Wen </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 16, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">May 16, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1. OVERVIEW</h1>
<p>FishEye International is collaborating with the country of Oceanus to identify companies who could potentially engaged in illegal, unreported, and unregulated (IUU) fishing. FishEye has transformed import/export data into a knowledge graph.</p>
<p>The country of Oceanus has sought FishEye International’s help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing.</p>
<p>With reference to <a href="https://vast-challenge.github.io/2023/MC2.html">Mini-Challenge 2</a> of <a href="https://vast-challenge.github.io/2023/">VAST Challenge 2023</a> and by using appropriate <strong>static and interactive statistical graphics</strong> methods, you are required to help FishEye identify companies that may be engaged in illegal fishing?</p>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task">1.1 The Task</h2>
<p>In this take-home exercise…</p>
</section>
</section>
<section id="datasets" class="level1">
<h1>2. Datasets</h1>
<p>The trade data is stored in <em>mc2_challenge_graph.json</em> file with a time period of 7 years from the time period 2028 to 2024. It includes a bundles with 12 types of marine species, ranging from Carp, Shark, to Tuna.</p>
</section>
<section id="data-preparation" class="level1">
<h1>3. Data Preparation</h1>
<section id="install-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-r-packages">3.1 Install R-packages</h2>
<p>Using p_load() of pacman package to load and install the following libraries:</p>
<ul>
<li><p><code>jsonlite</code> : To import data from JSON file into R</p></li>
<li><p><code>lubridate</code> : To convert date and time</p></li>
<li><p><code>dplyr</code>:</p></li>
<li><p><code>visNetwork</code>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman <span class="sc">::</span> <span class="fu">p_load</span> (jsonlite, lubridate, tidygraph, ggraph, visNetwork, tidyverse,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                  igraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-data">3.2 Importing Data</h2>
<p>There are 13 JSON files that will be imported into R the <code>fromJSON</code> function from <code>jsonlite</code>. The code chunk below shows the knowledge graph FishEye created from trade records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC2_challenge <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>MC2_carp <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/carp.json"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>MC2_catfish <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/catfish.json"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/chub_mackerel.json"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>MC2_cod2 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/cod2.json"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>MC2_herring <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/herring.json"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>MC2_lichen <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/lichen.json"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>MC2_mackerel <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/mackerel.json"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>MC2_pollock <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/pollock.json"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/salmon_wgl.json"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>MC2_salmon <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/salmon.json"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>MC2_shark <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/shark.json"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>MC2_tuna <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/tuna.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-tibble-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="create-tibble-dataframe">3.3 Create Tibble Dataframe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>MC2_challenge_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_challenge<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>MC2_challenge_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_challenge<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source,target,arrivaldate, hscode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1_fish type :carp</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>MC2_carp_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_carp<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>MC2_carp_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_carp<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#2_fish type: catfish</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>MC2_catfish_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_catfish<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>MC2_catfish_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_catfish<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#3_fish type: chub_mackerel</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_chub_mackerel<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_chub_mackerel<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#4_fish type: cod2</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>MC2_cod2_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_cod2<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>MC2_cod2_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_cod2<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#5_fish type: herring</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>MC2_herring_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_herring<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>MC2_herring_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_herring<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">#6_fish type: lichen</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>MC2_lichen_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_lichen<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>MC2_lichen_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_lichen<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co">#7_fish type: mackerel</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>MC2_mackerel_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_mackerel<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>MC2_mackerel_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_mackerel<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co">#8_fish type: pollock</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>MC2_pollock_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_pollock<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>MC2_pollock_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_pollock<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co">#9_fish type: salmon_wgl</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon_wgl<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon_wgl<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="co">#10_fish type: salmon</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>MC2_salmon_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>MC2_salmon_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co">#11_fish type: shark</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>MC2_shark_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_shark<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>MC2_shark_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_shark<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co">#12_fish type: tuna</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>MC2_tuna_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_tuna<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>MC2_tuna_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_tuna<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="concatenate-tibble-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="concatenate-tibble-dataframe">3.4 Concatenate Tibble Dataframe</h2>
<p>Among the 12 files, there are 3 data frames which have 7 variables whereas the rest have 9 variables. As such, <code>bind_rows()</code> - a function from the <code>dplyr</code> package within the <code>tidyverse</code> is used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>combined_edges <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(MC2_carp_edges,MC2_chub_mackerel_edges,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                        MC2_cod2_edges,MC2_herring_edges,MC2_lichen_edges,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                        MC2_pollock_edges,MC2_salmon_wgl_edges,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                        MC2_salmon_edges,MC2_shark_edges, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                        MC2_catfish_edges,MC2_mackerel_edges,MC2_tuna_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-Tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Catfish, Mackerel, and Tuna have 7 variables while other fishes have 9 variables. It is better to concatenate with the use <code>blind_rows</code> instead of <code>rbind()</code> as the latter requires an exact match in the numbers of columns.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>combined_nodes <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(MC2_carp_nodes,MC2_catfish_nodes, MC2_chub_mackerel_nodes,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                            MC2_cod2_nodes, MC2_herring_nodes, MC2_lichen_nodes,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                            MC2_mackerel_nodes, MC2_pollock_nodes, MC2_salmon_wgl_nodes,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                            MC2_salmon_nodes, MC2_shark_nodes, MC2_tuna_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-a-master-id-data-frame" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-master-id-data-frame">Creating a Master ID data frame</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>MC2_id_list <span class="ot">&lt;-</span> MC2_challenge_nodes <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trade_status =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import &amp; Export"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">~</span> <span class="st">"Export"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(shpcountry) <span class="sc">|</span> <span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span><span class="st">"Unknown"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>MC2_id_list <span class="ot">&lt;-</span> MC2_id_list <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(label,trade_status,shpcountry, rcvcountry)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#master ID list for visNetwork </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>MC2_id_list_vis <span class="ot">&lt;-</span> MC2_challenge_nodes <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(MC2_challenge_nodes)),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">trade_status =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import &amp; Export"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">~</span> <span class="st">"Export"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(shpcountry) <span class="sc">|</span> <span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span><span class="st">"Unknown"</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(trade_status))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>MC2_id_list_vis <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,label, trade_status,shpcountry, rcvcountry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to identify companies in target column that are not in the nodes </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ID_target <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(target <span class="sc">%in%</span> MC2_id_list<span class="sc">$</span>label)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rename to match names in nodes df</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dummy columns are created to bind rows together</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dataset =</span> <span class="cn">NA</span>, <span class="at">shpcountry =</span> <span class="cn">NA</span>, <span class="at">rcvcountry =</span> <span class="cn">NA</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to identify companies in source column that are not in the nodes </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>ID_source <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(source <span class="sc">%in%</span> MC2_id_list<span class="sc">$</span>label)) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(source)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#append the distinct companies into the nodes </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>MC2_challenge_nodes <span class="ot">&lt;-</span> MC2_challenge_nodes <span class="sc">%&gt;%</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(ID_target) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are 24 companies on the <code>target</code> column that are not included in the list. Meanwhile, there are no data available in the <code>source</code> column that are not in the list.</p>
<p>The <code>!is.na()</code> functions help to check for non-missing values in the specified column. In this combined_nodes data frame, the ID only corresponds to either the shipping country or the receiving country. Therefore, it is further segregated into import and export.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(MC2_id_list))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">3.5 Data Wrangling</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#revise the data format for arrivaldate and hscode </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>MC2_challenge_edges<span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sourcelabel =</span> source, <span class="at">targetlabel =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">#to append correspoinding id through left_join </span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>MC2_challenge_edges <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(MC2_id_list_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourcelabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">source =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(MC2_id_list_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetlabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">target =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>combined_edges_cleaned<span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>combined_edges_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,569 × 9
   source        target dataset generated_by arrivaldate hscode valueofgoods_omu
   &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;        &lt;date&gt;      &lt;chr&gt;             &lt;dbl&gt;
 1 Tshimbua Gmb… "Cara… MC2     carp         2034-03-20  80440             15915
 2 Marine Maste… "Play… MC2     carp         2034-08-01  940179               NA
 3 Marine Maste… "Salt… MC2     carp         2034-11-27  940161               NA
 4 Marine Maste… "Salt… MC2     carp         2034-10-10  940161               NA
 5 zhāng yú Ges… "Port… MC2     carp         2034-04-09  40729                NA
 6 Nile   S.A. … "Cara… MC2     carp         2034-03-30  700711               NA
 7 Nile   S.A. … "Play… MC2     carp         2034-03-12  701090               NA
 8 AquaBite Lim… "Mar … MC2     carp         2034-04-02  160419            63125
 9 Limpopo Rive… "Bu y… MC2     carp         2034-01-26  841950               NA
10 Bu yu wang NV "Lake… MC2     carp         2034-12-06  200600            57020
# ℹ 2,559 more rows
# ℹ 2 more variables: volumeteu &lt;dbl&gt;, weightkg &lt;int&gt;</code></pre>
</div>
</div>
<section id="data-wrangling-for-bundles" class="level4">
<h4 class="anchored" data-anchor-id="data-wrangling-for-bundles">3.5.1 Data Wrangling for Bundles</h4>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1_fish type: carp</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>MC2_carp_edges_cleaned <span class="ot">&lt;-</span> MC2_carp_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co">#2_fish type: catfish</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>MC2_catfish_edges_cleaned <span class="ot">&lt;-</span> MC2_catfish_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#3_fish type: chub_mackerel</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel_edges_cleaned <span class="ot">&lt;-</span> MC2_chub_mackerel_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co">#4_fish type: cod2</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>MC2_cod2_edges_cleaned <span class="ot">&lt;-</span> MC2_cod2_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="co">#5_fish type: herring</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>MC2_herring_edges_cleaned <span class="ot">&lt;-</span> MC2_herring_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co">#6_fish type: lichen</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>MC2_lichen_edges_cleaned <span class="ot">&lt;-</span> MC2_lichen_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#7_fish type: mackerel</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>MC2_mackerel_edges_cleaned <span class="ot">&lt;-</span> MC2_mackerel_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co">#8_fish type: pollock</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>MC2_pollock_edges_cleaned <span class="ot">&lt;-</span> MC2_pollock_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co">#9_fish type: salmon_wgl</span></span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl_edges_cleaned <span class="ot">&lt;-</span> MC2_salmon_wgl_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co">#10_fish type: salmon</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>MC2_salmon_edges_cleaned <span class="ot">&lt;-</span> MC2_salmon_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a><span class="co">#11_fish type: shark</span></span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>MC2_shark_edges_cleaned <span class="ot">&lt;-</span> MC2_shark_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a><span class="co">#12_fish type: tuna</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>MC2_tuna_edges_cleaned <span class="ot">&lt;-</span> MC2_tuna_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Danger
</div>
</div>
<div class="callout-body-container callout-body">
<p>HS code, also known as The Harmonized System are alphanumeric codes used for classifying goods for international trade and customs purposes. In this exercise, the HS code does not correspond to the respective goods.</p>
</div>
</div>
<p>Weights: Median = 2 , Mean = 22 , Min = 1, Max, 47134</p>
</section>
<section id="top-30-source-and-top-30-target" class="level3">
<h3 class="anchored" data-anchor-id="top-30-source-and-top-30-target">TOP 30 SOURCE AND TOP 30 TARGET</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>MC2_challenge_source <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sourcelabel) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight =</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">30</span>,weight)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>MC2_challenge_target <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(targetlabel) <span class="sc">%&gt;%</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight =</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">30</span>,weight)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>MC2_challenge_source</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 2
   sourcelabel                                weight
   &lt;chr&gt;                                       &lt;int&gt;
 1 Fresh Limited Liability Company            153363
 2 Uttar Pradesh s CJSC                       117216
 3 Chhattisgarh   Marine ecology A/S Delivery 112071
 4 French Crab S.p.A. Worldwide                99659
 5 bǐ mù yú Sagl Distribution                  90000
 6 Coastal Cruisers Pic Shipping               82129
 7 Mar y Luna Sagl                             77095
 8 Marine Masterminds Dry dock                 75130
 9 Caracola del Este Corporation Express       68683
10 Zambezi Gorge  N.V. Transport               66562
# ℹ 20 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>MC2_challenge_target</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 2
   targetlabel                                  weight
   &lt;chr&gt;                                         &lt;int&gt;
 1 hǎi dǎn Corporation Wharf                    456617
 2 Caracola del Sol Services                    192995
 3 Saltwater Supreme ОАО Forwading              189435
 4 Costa de la Felicidad Shipping               162402
 5 Panope Limited Liability Company             160961
 6 Mar del Este CJSC                            127853
 7 Sailors and Surfers Incorporated Enterprises 106595
 8 Coral Cove BV Delivery                       104338
 9 Pao gan SE Seal                               95546
10 Sea Breezes GmbH &amp; Co. KG Shark               75250
# ℹ 20 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>revisedlist <span class="ot">&lt;-</span> MC2_challenge_edges<span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sourcelabel <span class="sc">%in%</span> MC2_challenge_source<span class="sc">$</span>sourcelabel) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(targetlabel <span class="sc">%in%</span> MC2_challenge_target<span class="sc">$</span>targetlabel) </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>revisedlist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 905,924 × 6
   source target arrivaldate hscode sourcelabel                  targetlabel    
   &lt;chr&gt;  &lt;chr&gt;  &lt;date&gt;      &lt;chr&gt;  &lt;chr&gt;                        &lt;chr&gt;          
 1 6      37     2028-01-02  852990 French Crab S.p.A. Worldwide Selous Game Re…
 2 6      37     2028-01-02  847160 French Crab S.p.A. Worldwide Selous Game Re…
 3 6      37     2028-01-04  847160 French Crab S.p.A. Worldwide Selous Game Re…
 4 6      37     2028-01-04  853690 French Crab S.p.A. Worldwide Selous Game Re…
 5 6      37     2028-01-04  852990 French Crab S.p.A. Worldwide Selous Game Re…
 6 6      37     2028-01-04  852990 French Crab S.p.A. Worldwide Selous Game Re…
 7 6      37     2028-01-07  847160 French Crab S.p.A. Worldwide Selous Game Re…
 8 6      37     2028-01-07  852990 French Crab S.p.A. Worldwide Selous Game Re…
 9 6      37     2028-01-11  853690 French Crab S.p.A. Worldwide Selous Game Re…
10 6      37     2028-01-11  845090 French Crab S.p.A. Worldwide Selous Game Re…
# ℹ 905,914 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>MC2_agg <span class="ot">&lt;-</span> revisedlist <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sourcelabel,targetlabel) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight =</span><span class="fu">n</span>(),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">duration =</span> ((<span class="fu">max</span>(arrivaldate) <span class="sc">-</span> <span class="fu">min</span>(arrivaldate)))) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(duration <span class="sc">!=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>MC2_agg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 583 × 4
   sourcelabel                                targetlabel        weight duration
   &lt;chr&gt;                                      &lt;chr&gt;               &lt;int&gt; &lt;drtn&gt;  
 1 Marine Masterminds Dry dock                Saltwater Supreme…  47134 2554 da…
 2 Oceanic Explorers Sashimi Inc Solutions    Oceanic Explorers…  46205 2235 da…
 3 French Crab S.p.A. Worldwide               Saltwater Supreme…  35898 2554 da…
 4 Chhattisgarh   Marine ecology A/S Delivery Chhattisgarh   Ma…  28788 2551 da…
 5 Coastal Cruisers Pic Shipping              Caracola del Sol …  23752 2553 da…
 6 Olas del Sur Sea                           Greek Sea Bass LLC  21969 2553 da…
 7 Uttar Pradesh s CJSC                       Sea Breezes GmbH …  20846 2553 da…
 8 Mar y Luna Sagl                            Panope Limited Li…  18066 2409 da…
 9 Mar y Luna Sagl                            Saltwater Supreme…  16547 2552 da…
10 Caracola del Este Corporation Express      hǎi dǎn Corporati…  15966 2551 da…
# ℹ 573 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>check_id <span class="ot">&lt;-</span> MC2_id_list <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label <span class="sc">%in%</span> revisedlist<span class="sc">$</span>sourcelabel <span class="sc">|</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>           label <span class="sc">%in%</span> revisedlist<span class="sc">$</span>targetlabel)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>check_id_vis <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label <span class="sc">%in%</span> revisedlist<span class="sc">$</span>sourcelabel <span class="sc">|</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>           label <span class="sc">%in%</span> revisedlist<span class="sc">$</span>targetlabel)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>check_id</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 58 × 4
   label                                      trade_status shpcountry rcvcountry
   &lt;chr&gt;                                      &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;     
 1 Olas del Mar Worldwide                     Import &amp; Ex… Oceanus    Oceanus   
 2 French Crab S.p.A. Worldwide               Import &amp; Ex… Kondanovia Utoporiana
 3 Panope Limited Liability Company           Import &amp; Ex… Vesperanda Oceanus   
 4 hǎi dǎn Corporation Wharf                  Import &amp; Ex… Marebak    Oceanus   
 5 Sea Breezes GmbH &amp; Co. KG Shark            Import &amp; Ex… Oceanus    Oceanus   
 6 Costa de la Felicidad Shipping             Import &amp; Ex… Alverossia Oceanus   
 7 Mar del Este CJSC                          Import &amp; Ex… Merigrad   Oceanus   
 8 Black Sea Tuna Snapper                     Import &amp; Ex… Puerto Sol Oceanus   
 9 Sailors and Surfers Incorporated Enterpri… Import &amp; Ex… Puerto Sol Oceanus   
10 Selous Game Reserve  S.A. de C.V.          Import &amp; Ex… Isliandor  Oceanus   
# ℹ 48 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>MC2_bytop30 <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> check_id,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">edges =</span> MC2_agg)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>MC2_bytop30</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 58 nodes and 583 edges
#
# A directed multigraph with 1 component
#
# A tibble: 58 × 4
  label                            trade_status    shpcountry rcvcountry
  &lt;chr&gt;                            &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;     
1 Olas del Mar Worldwide           Import &amp; Export Oceanus    Oceanus   
2 French Crab S.p.A. Worldwide     Import &amp; Export Kondanovia Utoporiana
3 Panope Limited Liability Company Import &amp; Export Vesperanda Oceanus   
4 hǎi dǎn Corporation Wharf        Import &amp; Export Marebak    Oceanus   
5 Sea Breezes GmbH &amp; Co. KG Shark  Import &amp; Export Oceanus    Oceanus   
6 Costa de la Felicidad Shipping   Import &amp; Export Alverossia Oceanus   
# ℹ 52 more rows
#
# A tibble: 583 × 4
   from    to weight duration 
  &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;drtn&gt;   
1    40    12  47134 2554 days
2    15    15  46205 2235 days
3     2    12  35898 2554 days
# ℹ 580 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> MC2_bytop30 <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness_centrality =</span> <span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> trade_status, <span class="at">size =</span>betweenness_centrality) ) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width=</span>weight), <span class="at">alpha =</span> <span class="fl">0.2</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>g <span class="sc">+</span><span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>combined_edges_rev <span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,target,generated_by) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span> ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>combined_nodes_rev <span class="ot">&lt;-</span>MC2_id_list <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label <span class="sc">%in%</span> combined_edges_rev<span class="sc">$</span>source <span class="sc">|</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>           label <span class="sc">%in%</span> combined_edges_rev<span class="sc">$</span>target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>MC2_import <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> combined_nodes_rev,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">edges =</span> combined_edges_rev,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>MC2_import</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 253 nodes and 216 edges
#
# A directed acyclic multigraph with 70 components
#
# A tibble: 253 × 4
  label                            trade_status    shpcountry  rcvcountry
  &lt;chr&gt;                            &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;     
1 French Crab S.p.A. Worldwide     Import &amp; Export Kondanovia  Utoporiana
2 hǎi dǎn Corporation Wharf        Import &amp; Export Marebak     Oceanus   
3 Sea Breezes GmbH &amp; Co. KG Shark  Import &amp; Export Oceanus     Oceanus   
4 Costa de la Felicidad Shipping   Import &amp; Export Alverossia  Oceanus   
5 Mar del Este CJSC                Import &amp; Export Merigrad    Oceanus   
6 Mandalore S.A. de C.V. Logistics Import &amp; Export Osterivaria Oceanus   
# ℹ 247 more rows
#
# A tibble: 216 × 4
   from    to generated_by  weight
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;int&gt;
1   131    15 chub_mackerel      2
2    69     5 chub_mackerel      6
3   167    29 salmon_wgl         3
# ℹ 213 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>MC2_import <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 253 nodes and 216 edges
#
# A directed acyclic multigraph with 70 components
#
# A tibble: 216 × 4
   from    to generated_by weight
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;         &lt;int&gt;
1   160   235 cod2            105
2   178   196 tuna            104
3   184   111 shark            87
4   251    15 cod2             52
5   214    71 lichen           48
6   163   127 cod2             36
# ℹ 210 more rows
#
# A tibble: 253 × 4
  label                           trade_status    shpcountry rcvcountry
  &lt;chr&gt;                           &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;     
1 French Crab S.p.A. Worldwide    Import &amp; Export Kondanovia Utoporiana
2 hǎi dǎn Corporation Wharf       Import &amp; Export Marebak    Oceanus   
3 Sea Breezes GmbH &amp; Co. KG Shark Import &amp; Export Oceanus    Oceanus   
# ℹ 250 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>fishes <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(MC2_import, <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> trade_status), <span class="at">size =</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight, <span class="at">color =</span> generated_by), <span class="at">alpha =</span> <span class="fl">0.2</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>fishes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="create-network-graph-for-fishes" class="level3">
<h3 class="anchored" data-anchor-id="create-network-graph-for-fishes">create network graph for fishes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>MC2_carp_agg <span class="ot">&lt;-</span> MC2_carp_edges <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,target) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight =</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>MC2_carp_nodes <span class="ot">&lt;-</span> MC2_carp_nodes <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(MC2_carp_nodes)) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label <span class="sc">%in%</span> MC2_carp_agg<span class="sc">$</span>source <span class="sc">|</span> label <span class="sc">%in%</span> MC2_carp_agg<span class="sc">$</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">5</span>,<span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-preparation-for-visnetwork" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation-for-visnetwork">Data Preparation for visNetwork</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>MC2_agg_rev <span class="ot">&lt;-</span> revisedlist <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(check_id_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourcelabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(check_id_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetlabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from, to) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>check_id_vis <span class="ot">&lt;-</span> check_id_vis <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> rcvcountry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(check_id_vis, MC2_agg_rev, <span class="at">main =</span><span class="st">"Top 30 source/targets"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span> <span class="co">#indicate direction </span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addFontAwesome</span>(<span class="at">name =</span> <span class="st">"font-awesome"</span>) <span class="sc">%&gt;%</span> <span class="co">#add icon to network </span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">shape =</span> <span class="st">"icon"</span>, <span class="at">icon=</span> <span class="fu">list</span>(<span class="at">code =</span><span class="st">"f21a"</span>, <span class="at">color =</span> <span class="st">"#3B9AB2"</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, </span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="co">#freeze network</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1c5eb94fd7bc9de0c6d7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1c5eb94fd7bc9de0c6d7">{"x":{"nodes":{"id":["5","6","8","9","11","18","19","22","26","37","44","49","52","53","59","82","84","88","94","95","97","133","162","199","206","211","215","218","226","255","268","272","291","307","326","339","364","367","376","379","394","419","449","482","488","538","539","571","581","584","629","858","964","1283","1292","1305","1721","9404"],"label":["Olas del Mar Worldwide","French Crab S.p.A. Worldwide","Panope Limited Liability Company","hǎi dǎn Corporation Wharf","Sea Breezes GmbH & Co. KG Shark","Costa de la Felicidad Shipping","Mar del Este CJSC","Black Sea Tuna Snapper","Sailors and Surfers Incorporated Enterprises","Selous Game Reserve  S.A. de C.V.","Caracola del Sol Services","Saltwater Supreme ОАО Forwading","Océano de Coral Corporation Express","Pao gan SE Seal","Oceanic Explorers Sashimi Inc Solutions","Playa de la Luna Incorporated","Uttarakhand  Market Limited Liability Company Nautical","Portuguese Tuna Incorporated Marine","Caracola Azul Oyj &","Coral Cove BV Delivery","Arunachal Pradesh s Brine","ReefRider Foods Ltd. Corporation Family","Kong zhong diao yu  Ges.m.b.H.","Náutica del Norte Kga Holdings","Ianira Starfish Sagl Import","SeaTree Ltd. Liability Co Holdings","Saltwater Supreme Pelican Ltd Enterprises","Orange River   GmbH & Co. KG Shipping","Zambezi Gorge  N.V. Transport","Chhattisgarh   Marine ecology A/S Delivery","Saltwater Symphony S.A. de C.V.","Pao gan LC Freight ","Mar y Luna Sagl","bǐ mù yú Sagl Distribution","Danish Shrimp Kga Solutions","Rift Valley fishery Inc","suō yú Incorporated Brothers","nián yú Ltd. Corporation","Fresh Limited Liability Company","Marine Masterminds Dry dock","Coastal Cruisers Pic Shipping","Marine Mates Cruise ship","Icelandic Cod Pier ОАО Transport","Arunachal Pradesh s A/S Transport","Uttar Pradesh s CJSC","Olas del Sur Sea","Greek Sea Bass LLC","Selous Game Reserve  A/S","Coastal Castaway Coast Corporation Worldwide","Dry Creek Pic Marine biology","Barents Sea Cod CJSC Export","Saltwater Sisters Inc Seafaring","Estrella del Mar Seafarer","Caracola del Este Corporation Express","Playa del Tesoro BV","Sea Breezes S.A. de C.V. Freight ","Tamil Nadu  Market Co","Fisherman's Bounty AG Solutions"],"trade_status":["Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export"],"shpcountry":["Oceanus","Kondanovia","Vesperanda","Marebak","Oceanus","Alverossia","Merigrad","Puerto Sol","Puerto Sol","Isliandor","Puerto Sol","Puerto Sol","Vesperanda","Alverossia","Oceanus","Kondanovia","Helixia","Oceanus","Playa Solis","Quornova","Nalakond","Oceanus","Oceanus","Merigrad","Rio Isla","Gavanovia","Puerto Sol","Marebak","Marebak","Oceanus","Marebak","-22004","Marebak","Alverossia","Rio Isla","Puerto del Mar","Marebak","Merigrad","Marebak","Marebak","Marebak","Alverossia","Utoporiana","Oceanus","Marebak","Rio Isla","Khamseena","Rio Isla","Alverossia","Vesperanda","Marebak","Alverossia","Oceanus","Oceanus","Kondanovia","Isliandor","Talandria","Marebak"],"group":["Oceanus","Utoporiana","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Anderia del Mar","Sol y Oceana","Oceanus","Oceanus","Oceanus","Marebak","Oceanus","Oceanus","Oceanus","Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Marebak","Coralmarica","Oceanus","Oceanus","Coralmarica","Oceanus","Oceanus","Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Marebak","Oceanus","Oceanus","Oceanus","Oceanus","Coralmarica","Oceanus","Luminkind"],"x":[-0.181500957243101,-0.316602672598375,-0.690505766113328,-0.380061572241441,-0.67563340979592,-0.269259620537712,-0.017464767035499,-0.565276638773322,-0.49567527894998,-0.129370966331434,-0.363078310847891,-0.426164823404071,-0.577432955081798,-0.476830213312293,1,0.117638543473233,-0.758719734796786,0.0647596865982192,0.061564361339413,-0.592103848777743,-0.582855325860462,-0.0118068875592735,-0.381432197494906,-0.340749281155663,-1,-0.374780075352436,-0.235349147174404,-0.40561170598935,-0.190622924800074,0.187742507618788,-0.491607109601269,-0.135967106406408,-0.267374511308064,-0.30348830362789,-0.801365698923363,-0.578922562945035,-0.158245652155157,-0.513620450376449,-0.246433805441404,-0.640037216804871,-0.155335607879045,-0.203165354436441,-0.761480090003347,0.432839202436547,-0.43348455642625,-0.577064239882072,-0.0073440323417564,-0.247775539608955,-0.0898659404042544,0.0295853894827649,-0.39008560603533,-0.0943635447482352,-0.0781336649082727,-0.0807932038928886,-0.66653192500315,-0.0544755179651459,-0.190857057550978,-0.5664208136426],"y":[0.134601263027773,0.628178660046172,0.569615495268682,0.321920377275785,0.675626397160021,0.256553800960811,0.313517309924566,0.585405008968438,0.323830470141147,0.349389172272532,0.267566345232554,0.682650168947119,0.717299967577786,0.22134292355793,-1,0.342828758335711,0.474308899439358,0.804892668806161,0.429847632180967,0.513799689999579,0.434945259613513,0.226288649690633,0.180726993188243,0.450244779941481,0.352216614169117,0.819262207093718,0.313637462118755,0.503915955807646,0.606930486903037,-0.0400744584558685,0.649368506414175,0.763409618740795,0.512370748438688,0.559226218807162,0.256860123800246,0.355065313333866,0.478559241485864,-0.011871167375907,0.622297782358955,0.0760953776623239,0.564314151133626,0.911838116920395,0.37626450574391,-0.362513202149479,0.401855436502039,0.791532051495058,1,0.42384855120081,0.236601689848204,0.581800039676479,0.560250530543885,0.673560912808282,0.43875354042992,0.535362120677594,0.277061493676565,0.112684915583765,-0.002983592521135,0.185459566553406]},"edges":{"from":["1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","206","206","206","206","206","206","206","206","206","206","206","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","255","255","255","255","255","255","255","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","326","326","326","326","326","326","326","326","326","326","326","326","326","326","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","367","367","367","367","367","367","367","367","367","367","367","367","367","367","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","379","379","379","379","379","379","379","379","379","379","379","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","449","449","449","449","449","449","449","449","449","449","449","449","449","449","449","449","482","482","482","482","482","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","538","538","538","538","538","538","538","538","538","538","538","538","538","538","538","538","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964"],"to":["133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","82","84","88","9","94","95","97","162","18","19","211","215","22","26","37","44","49","5","52","53","581","8","84","9","95","97","162","18","19","26","272","339","37","44","49","5","53","581","82","9","94","97","133","162","18","19","215","22","26","339","37","44","53","581","82","9","94","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","84","88","9","95","97","11","162","26","339","44","52","53","8","9","95","97","11","133","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","84","88","9","94","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","133","18","37","44","5","82","9","11","162","18","211","22","26","272","339","37","419","44","49","52","53","581","8","84","88","9","94","95","97","11","133","162","18","211","215","22","26","272","339","37","419","44","49","52","53","581","8","82","84","88","9","94","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","11","133","18","215","22","26","339","44","49","5","52","8","9","95","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","53","581","8","82","88","9","94","95","97","162","18","19","215","26","339","44","5","53","581","84","9","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","18","26","44","49","53","8","82","84","9","94","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","5","52","53","539","581","8","88","9","94","95","97","11","133","162","18","19","211","26","339","37","44","49","52","8","84","9","95","133","255","5","581","59","11","133","162","18","19","211","215","22","26","272","339","37","44","49","5","52","53","581","8","82","84","9","94","95","97","11","18","215","22","26","272","339","37","44","49","52","539","8","9","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","9","94","95","97","11","133","18","19","215","26","272","37","44","49","52","581","8","82","88","9","94","95","11","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","84","88","9","94","95","97","11","133","18","211","215","22","272","37","44","49","52","581","8","82","9","94","95","97","11","133","18","215","22","26","272","339","37","44","5","53","581","8","84","9","94","95","97","133","162","18","19","211","215","22","255","26","272","339","37","44","49","5","52","53","539","581","82","84","88","9","94","95","97"],"weight":[28,125,406,554,108,1364,689,274,282,282,508,15,3499,154,103,4,190,10,126,908,344,265,15966,43,1336,24,600,7827,18,42,11,11,122,4,558,1135,3,4,4,3,3,50,1759,445,267,940,632,1107,40,2,119,333,9442,179,2,4690,16,20,631,4,158,13984,340,240,1049,2,1751,143,5,86,1458,421,59,2,357,8,1330,2388,51,2675,17,77,3,4,1675,2,612,406,2758,942,5624,4,95,76,3060,5592,2,30,394,4970,6814,3,709,3,4,244,470,564,5,8941,5077,7113,2,8532,1234,1384,3,30,462,24,368,157,21,540,5266,1580,136,5,282,42,32,7187,12,11,195,8648,3952,2605,32,123,84,875,1663,328,688,304,491,792,486,848,1200,58,1567,871,996,435,1178,19,211,696,208,114,244,6154,244,957,153,16,8,3,3,78,2,4,1808,20,4165,9,9,296,32,40,141,2,514,9872,13,286,236,8675,10,92,2273,163,174,40,1734,24,159,5634,54,5,330,1132,198,89,618,2,1441,16547,13,1490,1172,18066,30,50,142,6386,453,566,60,2664,833,213,5619,44,43,91,1197,1765,785,2018,3052,187,371,13025,32,16,795,24,1068,4316,68,101,8,8707,2641,1367,75,95,159,78,92,30,4794,106,83,196,6678,1354,350,89,5,13,217,7,6665,592,2,55,2,1136,2,238,279,4347,2781,65,75,538,31,11,8,7,6665,1138,8,75,468,5989,299,834,2,5,71,91,2703,8,2,117,83,2,287,762,1072,3455,1147,626,957,1192,2415,752,1230,1372,430,2416,3080,1231,416,1531,122,505,1150,350,451,824,10598,1471,3684,672,2635,19,41,47134,8,70,15414,198,873,3,2,461,2914,29,3337,33,118,334,1211,756,4,41,44,10064,23752,3,2889,1970,25,131,538,11,6679,66,227,288,312,21,3816,15,4,3,201,451,2,568,18,329,1354,99,9399,4190,8,19,53,17,2,20846,4309,2,8889,11,23,74,235,551,1584,391,3238,6238,73,153,3137,2729,3871,15103,6,468,11367,215,126,20,42,521,367,65,243,284,53,92,24,197,11,21969,10,408,2,104,739,21,4,1527,44,2,1006,684,173,47,21,11,184,377,690,36,407,1395,3,1954,158,4492,27,150,46,6292,7,542,2,95,16,2265,438,343,512,2,562,13310,13,1301,3454,269,928,111,505,64,54,42,747,703,257,4,8,4484,18,258,35898,15,268,4,25,9,2086,1210,19,4,2052,2,63,1904,480,180,210,449,95,752,184,57,2532,155,153,429,60,848,1943,423,78,221,79,909,8,76,71,2685,283,3912,50,206,7,123,12,50,17,57,18,59,37,7,7,506,3,763,427,3237,17,3284,480,4457,2,234,2,102,409,1086,2619,18,237,4598,2683,142,2320,25,12,5,7,181,70,40,32,15,23,74,105,62,111,12,198,8,210,10,14,3,10,149,12,19,638,4,62,7]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"physics":false,"shape":"icon","icon":{"code":"f21a","color":"#3B9AB2"}},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123},"interaction":{"dragNodes":false,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["Oceanus","Utoporiana","Anderia del Mar","Sol y Oceana","Marebak","Coralmarica","Luminkind"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Top 30 source/targets","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"iconsRedraw":true,"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>top30_snt <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> check_id_vis,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> MC2_agg_rev,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>top30_snt <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 58 nodes and 588 edges
#
# A directed acyclic simple graph with 1 component
#
# A tibble: 588 × 3
   from    to weight
  &lt;int&gt; &lt;int&gt;  &lt;int&gt;
1    40    12  47134
2     2    12  35898
3    41    11  23752
4    46    47  21969
5    45     5  20846
6    33     3  18066
# ℹ 582 more rows
#
# A tibble: 58 × 5
  id    label                            trade_status    shpcountry group     
  &lt;chr&gt; &lt;chr&gt;                            &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;     
1 5     Olas del Mar Worldwide           Import &amp; Export Oceanus    Oceanus   
2 6     French Crab S.p.A. Worldwide     Import &amp; Export Kondanovia Utoporiana
3 8     Panope Limited Liability Company Import &amp; Export Vesperanda Oceanus   
# ℹ 55 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>snt <span class="ot">&lt;-</span> top30_snt <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness_centrality =</span> <span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>betweenness_centrality))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>snt <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="filter-unknown-status" class="level2">
<h2 class="anchored" data-anchor-id="filter-unknown-status">filter unknown status</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to filter list of unknown parties </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>unknownMC2_nodes <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trade_status <span class="sc">==</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to filter list of exporters who solely do export or both </span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>MC2_exporters <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trade_status <span class="sc">==</span> <span class="st">"Export"</span> <span class="sc">|</span> trade_status <span class="sc">==</span> <span class="st">"Import &amp; Export"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co">#append by matching exporters to the importers (list of unknown)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>unknownMC2 <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(MC2_exporters, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourcelabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(unknownMC2_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetlabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (<span class="sc">!</span><span class="fu">is.na</span>(to)) <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from,to) <span class="sc">%&gt;%</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>unknownMC2_revnodes <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> unknownMC2<span class="sc">$</span>from <span class="sc">|</span> id <span class="sc">%in%</span> unknownMC2<span class="sc">$</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> trade_status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Incorporate icons for node sharps from Font Awesome. Add in <code>addFontAwesome()</code> function and modify the shape and icon arguments to <code>VisNodes()</code>. Moreover, custom navigation have been included with the feature to zoomView, dragView.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create network diagram for exporters</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(unknownMC2_revnodes, unknownMC2, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Exporters who ship to &lt;br&gt; Unknown Origin&lt;br&gt;"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span> (<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span> <span class="co">#indicate direction </span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addFontAwesome</span>(<span class="at">name =</span> <span class="st">"font-awesome"</span>) <span class="sc">%&gt;%</span> <span class="co">#add icon to network </span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fill color and shape</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Unknown"</span>, <span class="at">shape =</span> <span class="st">"icon"</span>, </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">icon=</span> <span class="fu">list</span>(<span class="at">code =</span><span class="st">"f21a"</span>, <span class="at">color =</span> <span class="st">"#E1AF00"</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Import &amp; Export"</span>, <span class="at">shape =</span> <span class="st">"icon"</span>, </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">icon=</span> <span class="fu">list</span>(<span class="at">code =</span><span class="st">"f21a"</span>, <span class="at">color =</span> <span class="st">"#3B9AB2"</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="co">#freeze network</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ec346ae3eb3e7dc8673b" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ec346ae3eb3e7dc8673b">{"x":{"nodes":{"id":["1","2","9","19","20","24","26","37","49","61","63","67","68","69","70","89","90","91","93","95","99","122","124","131","138","143","149","158","171"],"label":["AquaDelight Inc and Son's","BaringoAmerica Marine Ges.m.b.H.","hǎi dǎn Corporation Wharf","Mar del Este CJSC","8.Marine United AG","SeaBass &  SE Tanker","Sailors and Surfers Incorporated Enterprises","Selous Game Reserve  S.A. de C.V.","Saltwater Supreme ОАО Forwading","ArawakFish Cargo Ges.m.b.H.","Punjab s Marine conservation","Kong zhong diao yu  A/S","Dry CreekWorldLogistics Ltd. Liability Co","-1515","Arunachal Pradesh s SRL","HomabayMarine Carriers N.V.","Selkie Ltd. Liability Co","lú yú GmbH & Co. KG","KambalaSea Freight  Inc","Coral Cove BV Delivery","Maacama Ocean Worldwide LLC","OranjestadCreek Express Sagl","-214","SamakaDredgeTransport OJSC","Fisherman's Best Marine conservation","SavanetaCreek Solutions NV","SouthSeafood Express Corp","StichtingMarine Shipping Company","SumacAmerica Transport GmbH & Co. KG"],"group":["Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Unknown","Unknown","Import & Export","Unknown","Import & Export","Unknown","Unknown","Unknown","Unknown"],"x":[0.815212781639831,0.754188914712431,-0.0157460413190331,0.943081209323766,0.832021579405692,0.216043634743859,0.640361086084039,0.224741330196867,-0.219485797275958,0.337953228979355,0.349709620972344,-0.302868193221029,-0.452348585161463,-0.688993127943028,-0.612464481310428,-0.0513313588942742,-0.287044557221247,0.126392078848583,-1,-0.920158787492115,-0.300243382079522,-0.247802818567141,-0.458923275889109,1,-0.93866410974717,0.336812089551191,0.115159835594209,-0.858305477945369,0.764812039130389],"y":[0.639031798908338,0.440541200985537,-0.509822891382059,-0.0741690143259689,-0.281684464208062,1,-0.465234100826972,-1,0.5745827445693,0.824326672279051,0.603125472489769,0.90899515095451,0.691877245063084,0.778090837790351,0.478912822344352,-0.158246829552897,-0.00503381971332939,0.060603700378995,0.220119970535957,0.0314319247576871,-0.448043992984438,-0.749320108204144,-0.891425465584207,0.136214494444982,-0.350370166343423,-0.470268500142412,-0.785143470531748,-0.540363747032645,-0.677586431052293]},"edges":{"from":["1","124","138","19","19","24","26","26","26","37","49","63","67","69","70","9","9","9","9","9","90","91","95"],"to":["2","122","158","131","20","61","143","171","20","149","68","61","68","68","68","122","143","149","89","99","89","89","93"],"weight":[2,2,2,2,2,2,2,2,2,2,4,2,4,4,4,3,2,2,2,2,2,2,2]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123},"groups":{"Unknown":{"shape":"icon","icon":{"code":"f21a","color":"#E1AF00"}},"useDefaultGroups":true,"Import & Export":{"shape":"icon","icon":{"code":"f21a","color":"#3B9AB2"}}},"interaction":{"dragNodes":false,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["Import & Export","Unknown"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Exporters who ship to <br> Unknown Origin<br>","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"iconsRedraw":true,"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="filter-for-companies-with-duplicated-entries" class="level1">
<h1>filter for companies with duplicated entries</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#detect duplicate rows and aggregate it </span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>MC2_dup_rows <span class="ot">&lt;-</span> MC2_challenge_edges[<span class="fu">duplicated</span>(MC2_challenge_edges),] <span class="sc">%&gt;%</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from,to) <span class="sc">%&gt;%</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">#create df with corresponding nodes </span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>MC2_dup_nodes <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> MC2_dup_rows<span class="sc">$</span>from <span class="sc">|</span> id <span class="sc">%in%</span> MC2_dup_rows<span class="sc">$</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> trade_status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are approximately 32% duplicated rows in the trade data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check for duplicates </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>dup <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(MC2_challenge_edges) <span class="sc">-</span> <span class="fu">nrow</span>(<span class="fu">unique</span>(MC2_challenge_edges)))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#reformat output </span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>dup_reformat <span class="ot">&lt;-</span> <span class="fu">format</span>(dup, <span class="at">big.mark=</span><span class="st">","</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print output</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>dup_reformat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "1,757,878"</code></pre>
</div>
</div>
</section>
<section id="references" class="level1">
<h1>References:</h1>
<p>https://vast-challenge.github.io/2023/MC2.html</p>
<p>https://www.nagraj.net/notes/visnetwork/</p>
<p>https://cran.r-project.org/web/packages/visNetwork/vignettes/Introduction-to-visNetwork.html</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../Take-Home_Ex/Take_Home_Ex01/Take-Home_Ex01.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Take Home Exercise 1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>