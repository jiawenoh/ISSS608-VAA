<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Oh Jia Wen">
<meta name="dcterms.date" content="2023-05-24">

<title>Take Home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../Take-Home_Ex/Take_Home_Ex01/Take-Home_Ex01.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="../../site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="../../site_libs/vis-9.1.0/vis-network.min.js"></script>
<script src="../../site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>
<link href="../../site_libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Take Home Exercise 2</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Welcome</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://isss608-ohjiawen.netlify.app/" title="" class="sidebar-tool px-1"><i class="bi bi-house-fill"></i></a>
    <a href="https://github.com/jiawenoh/ISSS608-VAA" title="" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
    <a href="https://www.linkedin.com/in/jia-wen-oh/" title="" class="sidebar-tool px-1"><i class="bi bi-linkedin"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">About</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Home</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about_me.html" class="sidebar-item-text sidebar-link">About Me</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Hands-on Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 6 Part One</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Hands-on_Ex/Hands-on_Ex06/Hands_on_Ex06_PartTwo.html" class="sidebar-item-text sidebar-link">Hands-on Exercise 6 Part Two</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">In-class Exercise</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" class="sidebar-item-text sidebar-link">In-class Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" class="sidebar-item-text sidebar-link">In-class Exercise 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" class="sidebar-item-text sidebar-link">In-class Exercise 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" class="sidebar-item-text sidebar-link">In-class Exercise 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" class="sidebar-item-text sidebar-link">In-class Exercise 6</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Take Home Exercise</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take_Home_Ex01/Take-Home_Ex01.html" class="sidebar-item-text sidebar-link">Take Home Exercise 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Take-Home_Ex/Take_Home_Ex02/Take-Home_Ex02.html" class="sidebar-item-text sidebar-link active">Take Home Exercise 2</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">1. OVERVIEW</a>
  <ul class="collapse">
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task">1.1 The Task</a></li>
  </ul></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets">2. Datasets</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">3. Data Preparation</a>
  <ul class="collapse">
  <li><a href="#install-r-packages" id="toc-install-r-packages" class="nav-link" data-scroll-target="#install-r-packages">3.1 Install R-packages</a></li>
  <li><a href="#importing-data" id="toc-importing-data" class="nav-link" data-scroll-target="#importing-data">3.2 Importing Data</a></li>
  <li><a href="#create-tibble-dataframe" id="toc-create-tibble-dataframe" class="nav-link" data-scroll-target="#create-tibble-dataframe">3.3 Create Tibble Dataframe</a></li>
  <li><a href="#concatenate-tibble-dataframe" id="toc-concatenate-tibble-dataframe" class="nav-link" data-scroll-target="#concatenate-tibble-dataframe">3.4 Concatenate Tibble Dataframe</a></li>
  <li><a href="#creating-a-master-id-data-frame" id="toc-creating-a-master-id-data-frame" class="nav-link" data-scroll-target="#creating-a-master-id-data-frame">Creating a Master ID data frame</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">3.5 Data Wrangling</a></li>
  </ul></li>
  <li><a href="#distribution-of-transactions" id="toc-distribution-of-transactions" class="nav-link" data-scroll-target="#distribution-of-transactions">Distribution of transactions</a></li>
  <li><a href="#plot-with-ggplotly" id="toc-plot-with-ggplotly" class="nav-link" data-scroll-target="#plot-with-ggplotly">Plot with <code>ggplotly</code></a></li>
  <li><a href="#distribution-of-hscode" id="toc-distribution-of-hscode" class="nav-link" data-scroll-target="#distribution-of-hscode">Distribution of HScode</a>
  <ul class="collapse">
  <li><a href="#data-preparation-for-visnetwork" id="toc-data-preparation-for-visnetwork" class="nav-link" data-scroll-target="#data-preparation-for-visnetwork">Data Preparation for visNetwork</a>
  <ul class="collapse">
  <li><a href="#top-30-source-and-top-30-target" id="toc-top-30-source-and-top-30-target" class="nav-link" data-scroll-target="#top-30-source-and-top-30-target">TOP 30 SOURCE AND TOP 30 TARGET</a></li>
  </ul></li>
  <li><a href="#filter-unknown-status" id="toc-filter-unknown-status" class="nav-link" data-scroll-target="#filter-unknown-status">filter unknown status</a></li>
  </ul></li>
  <li><a href="#filter-for-companies-with-duplicated-entries" id="toc-filter-for-companies-with-duplicated-entries" class="nav-link" data-scroll-target="#filter-for-companies-with-duplicated-entries">filter for companies with duplicated entries</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Take Home Exercise 2</h1>
<p class="subtitle lead">Mini Case 2 of Vast Challenge 2023</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Oh Jia Wen </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 24, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">May 24, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>1. OVERVIEW</h1>
<p>FishEye International is collaborating with the country of Oceanus to identify companies who could potentially engaged in illegal, unreported, and unregulated (IUU) fishing. FishEye has transformed import/export data into a knowledge graph.</p>
<p>The country of Oceanus has sought FishEye International’s help in identifying companies possibly engaged in illegal, unreported, and unregulated (IUU) fishing.</p>
<p>With reference to <a href="https://vast-challenge.github.io/2023/MC2.html">Mini-Challenge 2</a> of <a href="https://vast-challenge.github.io/2023/">VAST Challenge 2023</a> and by using appropriate <strong>static and interactive statistical graphics</strong> methods, you are required to help FishEye identify companies that may be engaged in illegal fishing?</p>
<section id="the-task" class="level2">
<h2 class="anchored" data-anchor-id="the-task">1.1 The Task</h2>
<p>In this take-home exercise…</p>
</section>
</section>
<section id="datasets" class="level1">
<h1>2. Datasets</h1>
<p>The trade data is stored in <em>mc2_challenge_graph.json</em> file with a time period of 7 years from the time period 2028 to 2024. It includes a bundles with 12 types of marine species, ranging from Carp, Shark, to Tuna.</p>
</section>
<section id="data-preparation" class="level1">
<h1>3. Data Preparation</h1>
<section id="install-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-r-packages">3.1 Install R-packages</h2>
<p>Using p_load() of pacman package to load and install the following libraries:</p>
<ul>
<li><p><code>jsonlite</code> : To Import Data from JSON File into R</p></li>
<li><p><code>lubridate</code> : To Convert Date and Time</p></li>
<li><p><code>visNetwork</code>: For Network Visualization</p></li>
<li><p><code>tidyverse</code>: A collection of R packages use in everyday data analyses. It is able to support data science, data wrangling, and analysis.</p></li>
<li><p><code>ggplot2</code>:</p></li>
<li><p><code>hrbrthemes</code>: For Additional Themes, and Utilities for ‘ggplot2’</p></li>
</ul>
<p><code>heatmaply</code> : might not be using</p>
<p><code>scales</code> : check at EOD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman <span class="sc">::</span> <span class="fu">p_load</span> (jsonlite, lubridate, tidygraph, ggraph, visNetwork, tidyverse,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                  igraph,ggplot2,heatmaply,hrbrthemes,scales,treemap, treemapify)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="importing-data" class="level2">
<h2 class="anchored" data-anchor-id="importing-data">3.2 Importing Data</h2>
<p>There are 13 JSON files that will be imported into R the <code>fromJSON</code> function from <code>jsonlite</code>. The code chunk below shows the knowledge graph FishEye created from trade records.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>MC2_challenge <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/mc2_challenge_graph.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>MC2_carp <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/carp.json"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>MC2_catfish <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/catfish.json"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/chub_mackerel.json"</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>MC2_cod2 <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/cod2.json"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>MC2_herring <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/herring.json"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>MC2_lichen <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/lichen.json"</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>MC2_mackerel <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/mackerel.json"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>MC2_pollock <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/pollock.json"</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/salmon_wgl.json"</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>MC2_salmon <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/salmon.json"</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>MC2_shark <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/shark.json"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>MC2_tuna <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/bundles/tuna.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-tibble-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="create-tibble-dataframe">3.3 Create Tibble Dataframe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>MC2_challenge_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_challenge<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,shpcountry,rcvcountry)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>MC2_challenge_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_challenge<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source,target,arrivaldate, hscode,valueofgoods_omu, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>         volumeteu, weightkg, valueofgoodsusd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1_fish type :carp</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>MC2_carp_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_carp<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>MC2_carp_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_carp<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#2_fish type: catfish</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>MC2_catfish_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_catfish<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>MC2_catfish_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_catfish<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#3_fish type: chub_mackerel</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_chub_mackerel<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_chub_mackerel<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#4_fish type: cod2</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>MC2_cod2_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_cod2<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>MC2_cod2_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_cod2<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="co">#5_fish type: herring</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>MC2_herring_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_herring<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>MC2_herring_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_herring<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a><span class="co">#6_fish type: lichen</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>MC2_lichen_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_lichen<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>MC2_lichen_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_lichen<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a><span class="co">#7_fish type: mackerel</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>MC2_mackerel_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_mackerel<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>MC2_mackerel_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_mackerel<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">4</span>)</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co">#8_fish type: pollock</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>MC2_pollock_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_pollock<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>MC2_pollock_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_pollock<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a><span class="co">#9_fish type: salmon_wgl</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon_wgl<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon_wgl<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a><span class="co">#10_fish type: salmon</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>MC2_salmon_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>MC2_salmon_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_salmon<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">7</span>,<span class="dv">6</span>)</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a><span class="co">#11_fish type: shark</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>MC2_shark_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_shark<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>MC2_shark_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_shark<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">relocate</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true" tabindex="-1"></a><span class="co">#12_fish type: tuna</span></span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true" tabindex="-1"></a>MC2_tuna_nodes <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_tuna<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,dataset,shpcountry,rcvcountry)</span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true" tabindex="-1"></a>MC2_tuna_edges <span class="ot">&lt;-</span><span class="fu">as_tibble</span>(MC2_tuna<span class="sc">$</span>links) <span class="sc">%&gt;%</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="concatenate-tibble-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="concatenate-tibble-dataframe">3.4 Concatenate Tibble Dataframe</h2>
<p>Among the 12 files, there are 3 data frames which have 7 variables whereas the rest have 9 variables. As such, <code>bind_rows()</code> - a function from the <code>dplyr</code> package within the <code>tidyverse</code> is used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>combined_edges <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(MC2_carp_edges,MC2_chub_mackerel_edges,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                        MC2_cod2_edges,MC2_herring_edges,MC2_lichen_edges,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                        MC2_pollock_edges,MC2_salmon_wgl_edges,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                        MC2_salmon_edges,MC2_shark_edges, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                        MC2_catfish_edges,MC2_mackerel_edges,MC2_tuna_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-Tip callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Catfish, Mackerel, and Tuna have 7 variables while other fishes have 9 variables. It is better to concatenate with the use <code>blind_rows</code> instead of <code>rbind()</code> as the latter requires an exact match in the numbers of columns.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>combined_nodes <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(MC2_carp_nodes,MC2_catfish_nodes,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                            MC2_chub_mackerel_nodes,MC2_cod2_nodes,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                            MC2_herring_nodes, MC2_lichen_nodes,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                            MC2_mackerel_nodes, MC2_pollock_nodes, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                            MC2_salmon_wgl_nodes,MC2_salmon_nodes,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                            MC2_shark_nodes, MC2_tuna_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-a-master-id-data-frame" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-master-id-data-frame">Creating a Master ID data frame</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>MC2_id_list <span class="ot">&lt;-</span> MC2_challenge_nodes <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trade_status =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import &amp; Export"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">~</span> <span class="st">"Export"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import"</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(shpcountry) <span class="sc">|</span> <span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span><span class="st">"Unknown"</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  )) </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>MC2_id_list <span class="ot">&lt;-</span> MC2_id_list <span class="sc">%&gt;%</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(label,trade_status,shpcountry, rcvcountry)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">#master ID list for visNetwork </span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>MC2_id_list_vis <span class="ot">&lt;-</span> MC2_challenge_nodes <span class="sc">%&gt;%</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">label =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(MC2_challenge_nodes)),</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">trade_status =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import &amp; Export"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(shpcountry) <span class="sc">~</span> <span class="st">"Export"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span> <span class="st">"Import"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">is.na</span>(shpcountry) <span class="sc">|</span> <span class="fu">is.na</span>(rcvcountry) <span class="sc">~</span><span class="st">"Unknown"</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(trade_status))</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>MC2_id_list_vis <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,label, trade_status,shpcountry, rcvcountry)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to identify companies in target column that are not in the nodes </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ID_target <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(target <span class="sc">%in%</span> MC2_id_list<span class="sc">$</span>label)) <span class="sc">%&gt;%</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(target) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#rename to match names in nodes df</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#dummy columns are created to bind rows together</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dataset =</span> <span class="cn">NA</span>, <span class="at">shpcountry =</span> <span class="cn">NA</span>, <span class="at">rcvcountry =</span> <span class="cn">NA</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to identify companies in source column that are not in the nodes </span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>ID_source <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(source <span class="sc">%in%</span> MC2_id_list<span class="sc">$</span>label)) <span class="sc">%&gt;%</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(source) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dataset =</span> <span class="cn">NA</span>, <span class="at">shpcountry =</span> <span class="cn">NA</span>, <span class="at">rcvcountry =</span> <span class="cn">NA</span>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#append the distinct companies into the nodes </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>MC2_challenge_nodes <span class="ot">&lt;-</span> MC2_challenge_nodes <span class="sc">%&gt;%</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(ID_target) <span class="sc">%&gt;%</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(ID_source)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#output of ID nodes that are not in Master list</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ID_source)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ID_target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>There are 0 companies on the <code>target</code> column that are not included in the list. Meanwhile, there are no data available in the <code>source</code> column that are not in the list.</p>
<p>The <code>!is.na()</code> functions help to check for non-missing values in the specified column. In this combined_nodes data frame, the ID only corresponds to either the shipping country or the receiving country. Therefore, it is further segregated into import and export.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(MC2_id_list))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">3.5 Data Wrangling</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#revise the data format for arrivaldate and hscode </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>MC2_challenge_edges<span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sourcelabel =</span> source, <span class="at">targetlabel =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">year</span>(arrivaldate))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">#to append correspoinding id through left_join </span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>MC2_challenge_edges <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(MC2_id_list_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourcelabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">source =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(MC2_id_list_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetlabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">target =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="dv">10</span>,<span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>combined_edges_cleaned<span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>combined_edges_cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,569 × 9
   source        target dataset generated_by arrivaldate hscode valueofgoods_omu
   &lt;chr&gt;         &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;        &lt;date&gt;      &lt;chr&gt;             &lt;dbl&gt;
 1 Tshimbua Gmb… "Cara… MC2     carp         2034-03-20  80440             15915
 2 Marine Maste… "Play… MC2     carp         2034-08-01  940179               NA
 3 Marine Maste… "Salt… MC2     carp         2034-11-27  940161               NA
 4 Marine Maste… "Salt… MC2     carp         2034-10-10  940161               NA
 5 zhāng yú Ges… "Port… MC2     carp         2034-04-09  40729                NA
 6 Nile   S.A. … "Cara… MC2     carp         2034-03-30  700711               NA
 7 Nile   S.A. … "Play… MC2     carp         2034-03-12  701090               NA
 8 AquaBite Lim… "Mar … MC2     carp         2034-04-02  160419            63125
 9 Limpopo Rive… "Bu y… MC2     carp         2034-01-26  841950               NA
10 Bu yu wang NV "Lake… MC2     carp         2034-12-06  200600            57020
# ℹ 2,559 more rows
# ℹ 2 more variables: volumeteu &lt;dbl&gt;, weightkg &lt;int&gt;</code></pre>
</div>
</div>
<section id="data-wrangling-for-bundles" class="level4">
<h4 class="anchored" data-anchor-id="data-wrangling-for-bundles">3.5.1 Data Wrangling for Bundles</h4>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1_fish type: carp</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>MC2_carp_edges_cleaned <span class="ot">&lt;-</span> MC2_carp_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#2_fish type: catfish</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>MC2_catfish_edges_cleaned <span class="ot">&lt;-</span> MC2_catfish_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#3_fish type: chub_mackerel</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>MC2_chub_mackerel_edges_cleaned <span class="ot">&lt;-</span> MC2_chub_mackerel_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co">#4_fish type: cod2</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>MC2_cod2_edges_cleaned <span class="ot">&lt;-</span> MC2_cod2_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co">#5_fish type: herring</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>MC2_herring_edges_cleaned <span class="ot">&lt;-</span> MC2_herring_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co">#6_fish type: lichen</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>MC2_lichen_edges_cleaned <span class="ot">&lt;-</span> MC2_lichen_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="co">#7_fish type: mackerel</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>MC2_mackerel_edges_cleaned <span class="ot">&lt;-</span> MC2_mackerel_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="co">#8_fish type: pollock</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>MC2_pollock_edges_cleaned <span class="ot">&lt;-</span> MC2_pollock_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="co">#9_fish type: salmon_wgl</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>MC2_salmon_wgl_edges_cleaned <span class="ot">&lt;-</span> MC2_salmon_wgl_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a><span class="co">#10_fish type: salmon</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>MC2_salmon_edges_cleaned <span class="ot">&lt;-</span> MC2_salmon_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a><span class="co">#11_fish type: shark</span></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>MC2_shark_edges_cleaned <span class="ot">&lt;-</span> MC2_shark_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a><span class="co">#12_fish type: tuna</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>MC2_tuna_edges_cleaned <span class="ot">&lt;-</span> MC2_tuna_edges <span class="sc">%&gt;%</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">arrivaldate =</span><span class="fu">ymd</span>(arrivaldate),</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>         <span class="at">hscode =</span> <span class="fu">as.character</span>(hscode))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Danger
</div>
</div>
<div class="callout-body-container callout-body">
<p>HS code, also known as The Harmonized System are alphanumeric codes used for classifying goods for international trade and customs purposes. In this exercise, the HS code does not correspond to the respective goods.</p>
</div>
</div>
<p>Weights: Median = 2 , Mean = 22 , Min = 1, Max, 47134</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>combined_edges_rev <span class="ot">&lt;-</span> combined_edges <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(source,target,generated_by) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span> ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>combined_nodes_rev <span class="ot">&lt;-</span>MC2_id_list <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label <span class="sc">%in%</span> combined_edges_rev<span class="sc">$</span>source <span class="sc">|</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>           label <span class="sc">%in%</span> combined_edges_rev<span class="sc">$</span>target)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>MC2_import <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> combined_nodes_rev,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">edges =</span> combined_edges_rev,</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>MC2_import</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 253 nodes and 216 edges
#
# A directed acyclic multigraph with 70 components
#
# A tibble: 253 × 4
  label                            trade_status    shpcountry  rcvcountry
  &lt;chr&gt;                            &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;     
1 French Crab S.p.A. Worldwide     Import &amp; Export Kondanovia  Utoporiana
2 hǎi dǎn Corporation Wharf        Import &amp; Export Marebak     Oceanus   
3 Sea Breezes GmbH &amp; Co. KG Shark  Import &amp; Export Oceanus     Oceanus   
4 Costa de la Felicidad Shipping   Import &amp; Export Alverossia  Oceanus   
5 Mar del Este CJSC                Import &amp; Export Merigrad    Oceanus   
6 Mandalore S.A. de C.V. Logistics Import &amp; Export Osterivaria Oceanus   
# ℹ 247 more rows
#
# A tibble: 216 × 4
   from    to generated_by  weight
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;int&gt;
1   131    15 chub_mackerel      2
2    69     5 chub_mackerel      6
3   167    29 salmon_wgl         3
# ℹ 213 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>MC2_import <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 253 nodes and 216 edges
#
# A directed acyclic multigraph with 70 components
#
# A tibble: 216 × 4
   from    to generated_by weight
  &lt;int&gt; &lt;int&gt; &lt;chr&gt;         &lt;int&gt;
1   160   235 cod2            105
2   178   196 tuna            104
3   184   111 shark            87
4   251    15 cod2             52
5   214    71 lichen           48
6   163   127 cod2             36
# ℹ 210 more rows
#
# A tibble: 253 × 4
  label                           trade_status    shpcountry rcvcountry
  &lt;chr&gt;                           &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;     
1 French Crab S.p.A. Worldwide    Import &amp; Export Kondanovia Utoporiana
2 hǎi dǎn Corporation Wharf       Import &amp; Export Marebak    Oceanus   
3 Sea Breezes GmbH &amp; Co. KG Shark Import &amp; Export Oceanus    Oceanus   
# ℹ 250 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>()</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>fishes <span class="ot">&lt;-</span> <span class="fu">ggraph</span>(MC2_import, <span class="at">layout =</span> <span class="st">"nicely"</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> trade_status), <span class="at">size =</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight, <span class="at">color =</span> generated_by), <span class="at">alpha =</span> <span class="fl">0.2</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>fishes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="distribution-of-transactions" class="level1">
<h1>Distribution of transactions</h1>
</section>
<section id="plot-with-ggplotly" class="level1">
<h1>Plot with <code>ggplotly</code></h1>
<p><code>scale_fill_distiller</code> to provide a ColorBrewer palette. Diverging palettes (third list of colors), which put equal emphasis on mid-range critical values and extremes at both ends of the data range. The diverging palettes are : BrBG, PiYG, PRGn, PuOr, RdBu, RdGy, RdYlBu, RdYlGn, Spectral</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>transaction_counts_by_year <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">round</span>(<span class="fu">month</span>(arrivaldate))) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,month) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(transaction_counts_by_year, </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> month, <span class="at">fill =</span> count)) <span class="sc">+</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"RdBu"</span>) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Month"</span>, <span class="at">title =</span> <span class="st">"Number of Transactions by Year and Month"</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">2028</span><span class="sc">:</span><span class="dv">2034</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(heatmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-433f0e91e86a4ef8665c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-433f0e91e86a4ef8665c">{"x":{"data":[{"x":[2028,2029,2030,2031,2032,2033,2034],"y":[1,2,3,4,5,6,7,8,9,10,11,12],"z":[[0.369658839830731,0.756132269782421,0.550275249971913,0.599483204134367,0.307381193124368,0.473280155787739,0.615885855521851],[0.373703329213946,0.332097517132906,0.44994944388271,0.393513837396547,0.174886716848294,0.214170692431562,0.2242819158896],[0.050181627532487,0.433659139422537,1,0.138598659326667,0.0586825450323934,0,0.110774070329176],[0.294798337265476,0.586600756469311,0.608658203198143,0.278545481781073,0.283938134292027,0.165187432123731,0.213421712916152],[0.533573006778265,0.718271355278433,0.772871961951841,0.469310564356065,0.326592517694641,0.43242332322211,0.295472418829345],[0.551773209002734,0.669924727558701,0.783357675167584,0.383402613938509,0.358499045051118,0.515148110699172,0.29217690896154],[0.676328502415459,0.735348088229787,0.77717859416545,0.501516683518706,0.64502115867131,0.624798711755233,0.486724338089353],[0.785192674980339,0.797588285960379,0.934838782159308,0.720068906115418,0.613676365951391,0.625884732052578,0.407182713552784],[0.669700033704078,0.881923379395574,0.92839755832678,0.365876493277909,0.389956184698348,0.661199116204172,0.0865820319814253],[0.550088005093061,0.9036063363667,0.908212560386473,0.468786278695278,0.378122308354866,0.785417368834962,0.10882672358911],[0.59607534733925,0.711343294760888,0.635733812680223,0.385012919896641,0.323072313972213,0.508894131745497,0.156199677938808],[0.637231771711044,0.661536156986106,0.355877616747182,0.357001086020297,0.311650376362206,0.578137287945175,0.0353892821031345]],"text":[["year: 2028<br />month:  1<br />count: 61943","year: 2029<br />month:  1<br />count: 72263","year: 2030<br />month:  1<br />count: 66766","year: 2031<br />month:  1<br />count: 68080","year: 2032<br />month:  1<br />count: 60280","year: 2033<br />month:  1<br />count: 64710","year: 2034<br />month:  1<br />count: 68518"],["year: 2028<br />month:  2<br />count: 62051","year: 2029<br />month:  2<br />count: 60940","year: 2030<br />month:  2<br />count: 64087","year: 2031<br />month:  2<br />count: 62580","year: 2032<br />month:  2<br />count: 56742","year: 2033<br />month:  2<br />count: 57791","year: 2034<br />month:  2<br />count: 58061"],["year: 2028<br />month:  3<br />count: 53412","year: 2029<br />month:  3<br />count: 63652","year: 2030<br />month:  3<br />count: 78775","year: 2031<br />month:  3<br />count: 55773","year: 2032<br />month:  3<br />count: 53639","year: 2033<br />month:  3<br />count: 52072","year: 2034<br />month:  3<br />count: 55030"],["year: 2028<br />month:  4<br />count: 59944","year: 2029<br />month:  4<br />count: 67736","year: 2030<br />month:  4<br />count: 68325","year: 2031<br />month:  4<br />count: 59510","year: 2032<br />month:  4<br />count: 59654","year: 2033<br />month:  4<br />count: 56483","year: 2034<br />month:  4<br />count: 57771"],["year: 2028<br />month:  5<br />count: 66320","year: 2029<br />month:  5<br />count: 71252","year: 2030<br />month:  5<br />count: 72710","year: 2031<br />month:  5<br />count: 64604","year: 2032<br />month:  5<br />count: 60793","year: 2033<br />month:  5<br />count: 63619","year: 2034<br />month:  5<br />count: 59962"],["year: 2028<br />month:  6<br />count: 66806","year: 2029<br />month:  6<br />count: 69961","year: 2030<br />month:  6<br />count: 72990","year: 2031<br />month:  6<br />count: 62310","year: 2032<br />month:  6<br />count: 61645","year: 2033<br />month:  6<br />count: 65828","year: 2034<br />month:  6<br />count: 59874"],["year: 2028<br />month:  7<br />count: 70132","year: 2029<br />month:  7<br />count: 71708","year: 2030<br />month:  7<br />count: 72825","year: 2031<br />month:  7<br />count: 65464","year: 2032<br />month:  7<br />count: 69296","year: 2033<br />month:  7<br />count: 68756","year: 2034<br />month:  7<br />count: 65069"],["year: 2028<br />month:  8<br />count: 73039","year: 2029<br />month:  8<br />count: 73370","year: 2030<br />month:  8<br />count: 77035","year: 2031<br />month:  8<br />count: 71300","year: 2032<br />month:  8<br />count: 68459","year: 2033<br />month:  8<br />count: 68785","year: 2034<br />month:  8<br />count: 62945"],["year: 2028<br />month:  9<br />count: 69955","year: 2029<br />month:  9<br />count: 75622","year: 2030<br />month:  9<br />count: 76863","year: 2031<br />month:  9<br />count: 61842","year: 2032<br />month:  9<br />count: 62485","year: 2033<br />month:  9<br />count: 69728","year: 2034<br />month:  9<br />count: 54384"],["year: 2028<br />month: 10<br />count: 66761","year: 2029<br />month: 10<br />count: 76201","year: 2030<br />month: 10<br />count: 76324","year: 2031<br />month: 10<br />count: 64590","year: 2032<br />month: 10<br />count: 62169","year: 2033<br />month: 10<br />count: 73045","year: 2034<br />month: 10<br />count: 54978"],["year: 2028<br />month: 11<br />count: 67989","year: 2029<br />month: 11<br />count: 71067","year: 2030<br />month: 11<br />count: 69048","year: 2031<br />month: 11<br />count: 62353","year: 2032<br />month: 11<br />count: 60699","year: 2033<br />month: 11<br />count: 65661","year: 2034<br />month: 11<br />count: 56243"],["year: 2028<br />month: 12<br />count: 69088","year: 2029<br />month: 12<br />count: 69737","year: 2030<br />month: 12<br />count: 61575","year: 2031<br />month: 12<br />count: 61605","year: 2032<br />month: 12<br />count: 60394","year: 2033<br />month: 12<br />count: 67510","year: 2034<br />month: 12<br />count: 53017"]],"colorscale":[[0,"#2166AC"],[0.0353892821031345,"#3574B3"],[0.050181627532487,"#3B79B7"],[0.0586825450323934,"#3F7DB8"],[0.0865820319814253,"#4A88BE"],[0.10882672358911,"#5391C3"],[0.110774070329176,"#5392C3"],[0.138598659326667,"#5D9DC9"],[0.156199677938808,"#63A5CD"],[0.165187432123731,"#66A8CF"],[0.174886716848294,"#6DACD1"],[0.213421712916152,"#87B9D8"],[0.214170692431562,"#88BAD8"],[0.2242819158896,"#8EBDDA"],[0.278545481781073,"#B0D1E5"],[0.283938134292027,"#B3D3E6"],[0.29217690896154,"#B8D6E8"],[0.294798337265476,"#BAD7E8"],[0.295472418829345,"#BAD7E9"],[0.307381193124368,"#C2DBEB"],[0.311650376362206,"#C4DDEC"],[0.323072313972213,"#CBE1EE"],[0.326592517694641,"#CDE3EF"],[0.332097517132906,"#D0E5F0"],[0.355877616747182,"#D6E7F1"],[0.357001086020297,"#D6E8F1"],[0.358499045051118,"#D7E8F1"],[0.365876493277909,"#D9E9F1"],[0.369658839830731,"#D9E9F2"],[0.373703329213946,"#DAE9F2"],[0.378122308354866,"#DBEAF2"],[0.383402613938509,"#DDEAF2"],[0.385012919896641,"#DDEBF2"],[0.389956184698348,"#DEEBF2"],[0.393513837396547,"#DFEBF3"],[0.407182713552784,"#E2EDF3"],[0.43242332322211,"#E8F0F4"],[0.433659139422537,"#E8F0F4"],[0.44994944388271,"#ECF2F5"],[0.468786278695278,"#F0F4F6"],[0.469310564356065,"#F0F4F6"],[0.473280155787739,"#F1F4F6"],[0.486724338089353,"#F4F6F6"],[0.501516683518706,"#F7F7F7"],[0.508894131745497,"#F7F5F4"],[0.515148110699172,"#F8F4F3"],[0.533573006778265,"#F9F1ED"],[0.550088005093061,"#F9EFE8"],[0.550275249971913,"#F9EFE8"],[0.551773209002734,"#FAEEE8"],[0.578137287945175,"#FBEAE0"],[0.586600756469311,"#FBE8DE"],[0.59607534733925,"#FBE7DB"],[0.599483204134367,"#FBE6DA"],[0.608658203198143,"#FCE5D8"],[0.613676365951391,"#FCE4D6"],[0.615885855521851,"#FCE4D5"],[0.624798711755233,"#FCE2D3"],[0.625884732052578,"#FCE2D3"],[0.635733812680223,"#FCE0D0"],[0.637231771711044,"#FCE0CF"],[0.64502115867131,"#FDDFCD"],[0.661199116204172,"#FDDCC9"],[0.661536156986106,"#FDDCC8"],[0.669700033704078,"#FDDAC5"],[0.669924727558701,"#FDD9C5"],[0.676328502415459,"#FDD6C1"],[0.711343294760888,"#FBC5AB"],[0.718271355278433,"#FBC2A7"],[0.720068906115418,"#FBC1A6"],[0.735348088229787,"#FABA9C"],[0.756132269782421,"#F8B090"],[0.772871961951841,"#F7A886"],[0.77717859416545,"#F6A583"],[0.783357675167584,"#F5A27F"],[0.785192674980339,"#F5A27E"],[0.785417368834962,"#F5A17E"],[0.797588285960379,"#F49C77"],[0.881923379395574,"#DE6D51"],[0.9036063363667,"#D6604A"],[0.908212560386473,"#D45D48"],[0.92839755832678,"#CD5142"],[0.934838782159308,"#CB4C3F"],[1,"#B2182B"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2028],"y":[1],"name":"99_425c092617c124d317ebe75e65d59cbc","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#2166AC"],[0.00334448160535128,"#2367AD"],[0.00668896321070228,"#2569AD"],[0.0100334448160536,"#276AAE"],[0.0133779264214046,"#296BAF"],[0.0167224080267558,"#2B6CB0"],[0.0200668896321071,"#2D6EB0"],[0.0234113712374581,"#2F6FB1"],[0.0267558528428094,"#3070B2"],[0.0301003344481607,"#3272B2"],[0.0334448160535117,"#3473B3"],[0.0367892976588629,"#3574B4"],[0.0401337792642139,"#3776B4"],[0.0434782608695652,"#3877B5"],[0.0468227424749165,"#3A78B6"],[0.0501672240802675,"#3B79B7"],[0.0535117056856188,"#3D7BB7"],[0.0568561872909698,"#3E7CB8"],[0.0602006688963211,"#407DB9"],[0.0635451505016723,"#417FB9"],[0.0668896321070233,"#4280BA"],[0.0702341137123746,"#4481BB"],[0.0735785953177259,"#4583BB"],[0.0769230769230769,"#4684BC"],[0.0802675585284282,"#4885BD"],[0.0836120401337792,"#4987BE"],[0.0869565217391304,"#4A88BE"],[0.0903010033444817,"#4C8ABF"],[0.0936454849498327,"#4D8BC0"],[0.096989966555184,"#4E8CC0"],[0.100334448160535,"#4F8EC1"],[0.103678929765886,"#518FC2"],[0.107023411371238,"#5290C3"],[0.110367892976589,"#5392C3"],[0.11371237458194,"#5493C4"],[0.117056856187291,"#5694C5"],[0.120401337792642,"#5796C5"],[0.123745819397993,"#5897C6"],[0.127090301003344,"#5999C7"],[0.130434782608696,"#5A9AC7"],[0.133779264214047,"#5C9BC8"],[0.137123745819398,"#5D9DC9"],[0.140468227424749,"#5E9ECA"],[0.1438127090301,"#5F9FCA"],[0.147157190635451,"#60A1CB"],[0.150501672240803,"#61A2CC"],[0.153846153846154,"#63A4CC"],[0.157190635451505,"#64A5CD"],[0.160535117056856,"#65A6CE"],[0.163879598662207,"#66A8CE"],[0.167224080267559,"#67A9CF"],[0.17056856187291,"#6AAAD0"],[0.173913043478261,"#6CACD0"],[0.177257525083612,"#6FADD1"],[0.180602006688963,"#71AED2"],[0.183946488294314,"#73AFD2"],[0.187290969899665,"#76B0D3"],[0.190635451505017,"#78B1D4"],[0.193979933110368,"#7AB3D4"],[0.197324414715719,"#7DB4D5"],[0.20066889632107,"#7FB5D6"],[0.204013377926422,"#81B6D6"],[0.207357859531773,"#83B7D7"],[0.210702341137124,"#85B9D8"],[0.214046822742475,"#88BAD8"],[0.217391304347826,"#8ABBD9"],[0.220735785953177,"#8CBCDA"],[0.224080267558528,"#8EBDDA"],[0.22742474916388,"#90BEDB"],[0.230769230769231,"#92C0DC"],[0.234113712374582,"#95C1DC"],[0.237458193979933,"#97C2DD"],[0.240802675585284,"#99C3DE"],[0.244147157190635,"#9BC4DE"],[0.247491638795987,"#9DC6DF"],[0.250836120401338,"#9FC7E0"],[0.254180602006689,"#A1C8E0"],[0.25752508361204,"#A3C9E1"],[0.260869565217391,"#A5CAE2"],[0.264214046822743,"#A7CCE2"],[0.267558528428094,"#A9CDE3"],[0.270903010033445,"#ABCEE4"],[0.274247491638796,"#AECFE4"],[0.277591973244147,"#B0D1E5"],[0.280936454849498,"#B2D2E6"],[0.284280936454849,"#B4D3E6"],[0.287625418060201,"#B6D4E7"],[0.290969899665552,"#B8D5E8"],[0.294314381270903,"#BAD7E8"],[0.297658862876254,"#BCD8E9"],[0.301003344481605,"#BED9EA"],[0.304347826086957,"#C0DAEA"],[0.307692307692308,"#C2DCEB"],[0.311036789297659,"#C4DDEC"],[0.31438127090301,"#C6DEEC"],[0.317725752508361,"#C8DFED"],[0.321070234113712,"#CAE0EE"],[0.324414715719064,"#CCE2EE"],[0.327759197324415,"#CEE3EF"],[0.331103678929766,"#D0E4F0"],[0.334448160535117,"#D1E5F0"],[0.337792642140468,"#D2E5F0"],[0.341137123745819,"#D3E6F0"],[0.34448160535117,"#D4E6F0"],[0.347826086956522,"#D4E7F1"],[0.351170568561873,"#D5E7F1"],[0.354515050167224,"#D6E7F1"],[0.357859531772575,"#D7E8F1"],[0.361204013377926,"#D7E8F1"],[0.364548494983278,"#D8E8F1"],[0.367892976588629,"#D9E9F1"],[0.37123745819398,"#DAE9F2"],[0.374581939799331,"#DBE9F2"],[0.377926421404682,"#DBEAF2"],[0.381270903010033,"#DCEAF2"],[0.384615384615385,"#DDEBF2"],[0.387959866220736,"#DEEBF2"],[0.391304347826087,"#DEEBF2"],[0.394648829431438,"#DFECF3"],[0.397993311036789,"#E0ECF3"],[0.401337792642141,"#E1ECF3"],[0.404682274247492,"#E1EDF3"],[0.408026755852843,"#E2EDF3"],[0.411371237458194,"#E3EDF3"],[0.414715719063545,"#E4EEF3"],[0.418060200668896,"#E4EEF4"],[0.421404682274248,"#E5EEF4"],[0.424749163879599,"#E6EFF4"],[0.42809364548495,"#E7EFF4"],[0.431438127090301,"#E8F0F4"],[0.434782608695652,"#E8F0F4"],[0.438127090301003,"#E9F0F4"],[0.441471571906354,"#EAF1F5"],[0.444816053511706,"#EBF1F5"],[0.448160535117057,"#EBF1F5"],[0.451505016722408,"#ECF2F5"],[0.454849498327759,"#EDF2F5"],[0.45819397993311,"#EEF2F5"],[0.461538461538462,"#EEF3F5"],[0.464882943143813,"#EFF3F6"],[0.468227424749164,"#F0F4F6"],[0.471571906354515,"#F1F4F6"],[0.474916387959866,"#F1F4F6"],[0.478260869565217,"#F2F5F6"],[0.481605351170568,"#F3F5F6"],[0.48494983277592,"#F4F5F6"],[0.488294314381271,"#F4F6F7"],[0.491638795986622,"#F5F6F7"],[0.494983277591973,"#F6F6F7"],[0.498327759197324,"#F7F7F7"],[0.501672240802675,"#F7F7F7"],[0.505016722408027,"#F7F6F6"],[0.508361204013378,"#F7F6F5"],[0.511705685618729,"#F8F5F4"],[0.51505016722408,"#F8F4F3"],[0.518394648829432,"#F8F4F2"],[0.521739130434783,"#F8F3F1"],[0.525083612040134,"#F8F3F0"],[0.528428093645485,"#F8F2EF"],[0.531772575250836,"#F9F2EE"],[0.535117056856187,"#F9F1ED"],[0.538461538461539,"#F9F1EC"],[0.54180602006689,"#F9F0EB"],[0.545150501672241,"#F9EFEA"],[0.548494983277592,"#F9EFE9"],[0.551839464882943,"#FAEEE8"],[0.555183946488294,"#FAEEE7"],[0.558528428093645,"#FAEDE6"],[0.561872909698997,"#FAEDE5"],[0.565217391304348,"#FAECE4"],[0.568561872909699,"#FAEBE3"],[0.57190635451505,"#FAEBE2"],[0.575250836120401,"#FAEAE1"],[0.578595317725752,"#FBEAE0"],[0.581939799331104,"#FBE9DF"],[0.585284280936455,"#FBE9DE"],[0.588628762541806,"#FBE8DD"],[0.591973244147157,"#FBE8DC"],[0.595317725752509,"#FBE7DB"],[0.598662207357859,"#FBE6DA"],[0.602006688963211,"#FBE6D9"],[0.605351170568562,"#FBE5D9"],[0.608695652173913,"#FCE5D8"],[0.612040133779264,"#FCE4D7"],[0.615384615384615,"#FCE4D6"],[0.618729096989967,"#FCE3D5"],[0.622073578595318,"#FCE2D4"],[0.625418060200669,"#FCE2D3"],[0.62876254180602,"#FCE1D2"],[0.632107023411371,"#FCE1D1"],[0.635451505016722,"#FCE0D0"],[0.638795986622074,"#FCE0CF"],[0.642140468227425,"#FCDFCE"],[0.645484949832776,"#FDDFCD"],[0.648829431438127,"#FDDECC"],[0.652173913043478,"#FDDDCB"],[0.655518394648829,"#FDDDCA"],[0.65886287625418,"#FDDCC9"],[0.662207357859532,"#FDDCC8"],[0.665551839464883,"#FDDBC7"],[0.668896321070234,"#FDDAC6"],[0.672240802675585,"#FDD8C3"],[0.675585284280936,"#FDD7C1"],[0.678929765886287,"#FDD5BF"],[0.682274247491639,"#FDD3BD"],[0.68561872909699,"#FDD2BB"],[0.688963210702341,"#FCD0B9"],[0.692307692307693,"#FCCFB7"],[0.695652173913043,"#FCCDB5"],[0.698996655518395,"#FCCBB3"],[0.702341137123745,"#FCCAB1"],[0.705685618729097,"#FCC8AF"],[0.709030100334448,"#FCC6AD"],[0.7123745819398,"#FBC5AA"],[0.715719063545151,"#FBC3A8"],[0.719063545150502,"#FBC2A6"],[0.722408026755853,"#FBC0A4"],[0.725752508361204,"#FBBEA2"],[0.729096989966555,"#FABDA0"],[0.732441471571906,"#FABB9E"],[0.735785953177258,"#FABA9C"],[0.739130434782609,"#FAB89A"],[0.74247491638796,"#F9B698"],[0.745819397993311,"#F9B596"],[0.749163879598662,"#F9B394"],[0.752508361204013,"#F9B192"],[0.755852842809365,"#F8B090"],[0.759197324414716,"#F8AE8E"],[0.762541806020067,"#F8AD8C"],[0.765886287625418,"#F7AB8A"],[0.769230769230769,"#F7A988"],[0.77257525083612,"#F7A886"],[0.775919732441471,"#F6A684"],[0.779264214046823,"#F6A482"],[0.782608695652174,"#F6A380"],[0.785953177257525,"#F5A17E"],[0.789297658862876,"#F5A07C"],[0.792642140468227,"#F49E7A"],[0.795986622073579,"#F49C78"],[0.79933110367893,"#F49B76"],[0.802675585284281,"#F39974"],[0.806020066889632,"#F39772"],[0.809364548494983,"#F29670"],[0.812709030100335,"#F2946E"],[0.816053511705686,"#F1926C"],[0.819397993311037,"#F1916A"],[0.822742474916388,"#F18F68"],[0.826086956521739,"#F08E66"],[0.82943143812709,"#F08C64"],[0.832775919732441,"#EF8A62"],[0.836120401337793,"#EE8861"],[0.839464882943144,"#ED8660"],[0.842809364548495,"#EC845F"],[0.846153846153846,"#EB825D"],[0.849498327759197,"#E9815C"],[0.852842809364548,"#E87F5B"],[0.8561872909699,"#E77D5A"],[0.859531772575251,"#E67B59"],[0.862876254180602,"#E57958"],[0.866220735785953,"#E37756"],[0.869565217391304,"#E27555"],[0.872909698996655,"#E17354"],[0.876254180602006,"#E07153"],[0.879598662207358,"#DF6F52"],[0.882943143812709,"#DE6D51"],[0.88628762541806,"#DC6B50"],[0.889632107023411,"#DB694E"],[0.892976588628763,"#DA674D"],[0.896321070234113,"#D9654C"],[0.899665551839465,"#D7634B"],[0.903010033444816,"#D6604A"],[0.906354515050167,"#D55E49"],[0.909698996655519,"#D45C48"],[0.91304347826087,"#D35A47"],[0.916387959866221,"#D15845"],[0.919732441471572,"#D05644"],[0.923076923076923,"#CF5443"],[0.926421404682274,"#CE5242"],[0.929765886287626,"#CC5041"],[0.933110367892977,"#CB4E40"],[0.936454849498328,"#CA4B3F"],[0.939799331103679,"#C9493E"],[0.94314381270903,"#C8473D"],[0.946488294314381,"#C6453C"],[0.949832775919732,"#C5423B"],[0.953177257525084,"#C44039"],[0.956521739130435,"#C33E38"],[0.959866220735786,"#C13B37"],[0.963210702341137,"#C03936"],[0.966555183946488,"#BF3735"],[0.969899665551839,"#BE3434"],[0.973244147157191,"#BC3133"],[0.976588628762542,"#BB2F32"],[0.979933110367893,"#BA2C31"],[0.983277591973244,"#B82930"],[0.986622073578595,"#B7262F"],[0.989966555183946,"#B6232E"],[0.993311036789297,"#B5202D"],[0.996655518394649,"#B31C2C"],[1,"#B2182B"]],"colorbar":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"thickness":23.04,"title":"count","titlefont":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"tickmode":"array","ticktext":["60000","70000"],"tickvals":[0.296895479908625,0.671385237613751],"tickfont":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":12.2208385222084},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"margin":{"t":95.7011207970112,"r":39.8505603985056,"b":89.5090614015124,"l":70.9007887090079},"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605},"title":{"text":"<b> Number of Transactions by Year and Month <\/b>","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":23.9103362391034},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[2027.15,2034.85],"tickmode":"array","ticktext":["2028","2029","2030","2031","2032","2033","2034"],"tickvals":[2028,2029,2030,2031,2032,2033,2034],"categoryorder":"array","categoryarray":["2028","2029","2030","2031","2032","2033","2034"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-45,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"y","title":{"text":"Year","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.1,13.1],"tickmode":"array","ticktext":["1","2","3","4","5","6","7","8","9","10","11","12"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"categoryorder":"array","categoryarray":["1","2","3","4","5","6","7","8","9","10","11","12"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.81901203819012,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"Arial Narrow","size":15.2760481527605},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(204,204,204,1)","gridwidth":0.265670402656704,"zeroline":false,"anchor":"x","title":{"text":"Month","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":11.9551681195517}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":12.2208385222084},"title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"Arial Narrow","size":15.2760481527605}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"846b31d40922":{"x":{},"y":{},"fill":{},"type":"heatmap"}},"cur_data":"846b31d40922","visdat":{"846b31d40922":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate to determine transactions count by year and month </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>transaction_counts_by_year <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">round</span>(<span class="fu">month</span>(arrivaldate))) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">#transpose df by using pivot_wider</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>pivoted_data <span class="ot">&lt;-</span> transaction_counts_by_year <span class="sc">%&gt;%</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> year, <span class="at">values_from =</span> count) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#remove the month column</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">8</span>)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">#convert pivoted_data into a matrix</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pivoted_data)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="co">#create interactive heatmap without dendrogram</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmaply</span>(heatmap_data, <span class="at">dendrogram =</span> <span class="st">"none"</span>,</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">ylab =</span> <span class="st">"Month"</span>,</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Number of Transactions by Year and Month"</span>,</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">scale =</span> <span class="st">"none"</span>,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">grid_color =</span> <span class="st">"white"</span>,</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">grid_width =</span> <span class="fl">0.00001</span>,</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">titleX =</span> <span class="cn">FALSE</span>,</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>          <span class="at">hide_colorbar =</span>  <span class="cn">FALSE</span>,</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>          <span class="at">label_names =</span> <span class="fu">c</span>(<span class="st">"Month:"</span>, <span class="st">"Year: "</span>, <span class="st">"No. of Transactions:"</span>),</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>          <span class="at">fontsize_row =</span> <span class="dv">10</span>, <span class="at">fontsize_col =</span> <span class="dv">10</span>,</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">colors =</span> <span class="st">"Blues"</span>,</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">labCol =</span> <span class="fu">colnames</span>(heatmap_data),</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">labRow =</span> <span class="fu">rownames</span>(heatmap_data),</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot_method =</span> <span class="st">"plotly"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-28d9a68ad5f85b505c19" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-28d9a68ad5f85b505c19">{"x":{"data":[{"colorbar":{"ticklen":2,"lenmode":"fraction","xanchor":"left","x":1.1,"y":0,"yanchor":"bottom","len":0.3,"thickness":30},"colorscale":[["0","rgba(247,251,255,1)"],["0.0416666666666667","rgba(239,246,252,1)"],["0.0833333333333333","rgba(230,240,250,1)"],["0.125","rgba(222,235,247,1)"],["0.166666666666667","rgba(214,230,244,1)"],["0.208333333333333","rgba(206,224,242,1)"],["0.25","rgba(198,219,239,1)"],["0.291666666666667","rgba(185,213,234,1)"],["0.333333333333333","rgba(172,208,230,1)"],["0.375","rgba(158,202,225,1)"],["0.416666666666667","rgba(142,193,221,1)"],["0.458333333333333","rgba(125,183,218,1)"],["0.5","rgba(107,174,214,1)"],["0.541666666666667","rgba(94,165,209,1)"],["0.583333333333333","rgba(81,155,203,1)"],["0.625","rgba(66,146,198,1)"],["0.666666666666667","rgba(57,135,192,1)"],["0.708333333333333","rgba(46,124,187,1)"],["0.75","rgba(33,113,181,1)"],["0.791666666666667","rgba(27,102,173,1)"],["0.833333333333333","rgba(19,91,164,1)"],["0.875","rgba(8,81,156,1)"],["0.916666666666667","rgba(9,70,139,1)"],["0.958333333333333","rgba(9,59,123,1)"],["1","rgba(8,48,107,1)"]],"showscale":true,"z":[[69088,69737,61575,61605,60394,67510,53017],[67989,71067,69048,62353,60699,65661,56243],[66761,76201,76324,64590,62169,73045,54978],[69955,75622,76863,61842,62485,69728,54384],[73039,73370,77035,71300,68459,68785,62945],[70132,71708,72825,65464,69296,68756,65069],[66806,69961,72990,62310,61645,65828,59874],[66320,71252,72710,64604,60793,63619,59962],[59944,67736,68325,59510,59654,56483,57771],[53412,63652,78775,55773,53639,52072,55030],[62051,60940,64087,62580,56742,57791,58061],[61943,72263,66766,68080,60280,64710,68518]],"x":[1,2,3,4,5,6,7],"y":[1,2,3,4,5,6,7,8,9,10,11,12],"text":[["Month:: 12<br>Year: : 2028<br>No. of Transactions:: 69088","Month:: 12<br>Year: : 2029<br>No. of Transactions:: 69737","Month:: 12<br>Year: : 2030<br>No. of Transactions:: 61575","Month:: 12<br>Year: : 2031<br>No. of Transactions:: 61605","Month:: 12<br>Year: : 2032<br>No. of Transactions:: 60394","Month:: 12<br>Year: : 2033<br>No. of Transactions:: 67510","Month:: 12<br>Year: : 2034<br>No. of Transactions:: 53017"],["Month:: 11<br>Year: : 2028<br>No. of Transactions:: 67989","Month:: 11<br>Year: : 2029<br>No. of Transactions:: 71067","Month:: 11<br>Year: : 2030<br>No. of Transactions:: 69048","Month:: 11<br>Year: : 2031<br>No. of Transactions:: 62353","Month:: 11<br>Year: : 2032<br>No. of Transactions:: 60699","Month:: 11<br>Year: : 2033<br>No. of Transactions:: 65661","Month:: 11<br>Year: : 2034<br>No. of Transactions:: 56243"],["Month:: 10<br>Year: : 2028<br>No. of Transactions:: 66761","Month:: 10<br>Year: : 2029<br>No. of Transactions:: 76201","Month:: 10<br>Year: : 2030<br>No. of Transactions:: 76324","Month:: 10<br>Year: : 2031<br>No. of Transactions:: 64590","Month:: 10<br>Year: : 2032<br>No. of Transactions:: 62169","Month:: 10<br>Year: : 2033<br>No. of Transactions:: 73045","Month:: 10<br>Year: : 2034<br>No. of Transactions:: 54978"],["Month:: 9<br>Year: : 2028<br>No. of Transactions:: 69955","Month:: 9<br>Year: : 2029<br>No. of Transactions:: 75622","Month:: 9<br>Year: : 2030<br>No. of Transactions:: 76863","Month:: 9<br>Year: : 2031<br>No. of Transactions:: 61842","Month:: 9<br>Year: : 2032<br>No. of Transactions:: 62485","Month:: 9<br>Year: : 2033<br>No. of Transactions:: 69728","Month:: 9<br>Year: : 2034<br>No. of Transactions:: 54384"],["Month:: 8<br>Year: : 2028<br>No. of Transactions:: 73039","Month:: 8<br>Year: : 2029<br>No. of Transactions:: 73370","Month:: 8<br>Year: : 2030<br>No. of Transactions:: 77035","Month:: 8<br>Year: : 2031<br>No. of Transactions:: 71300","Month:: 8<br>Year: : 2032<br>No. of Transactions:: 68459","Month:: 8<br>Year: : 2033<br>No. of Transactions:: 68785","Month:: 8<br>Year: : 2034<br>No. of Transactions:: 62945"],["Month:: 7<br>Year: : 2028<br>No. of Transactions:: 70132","Month:: 7<br>Year: : 2029<br>No. of Transactions:: 71708","Month:: 7<br>Year: : 2030<br>No. of Transactions:: 72825","Month:: 7<br>Year: : 2031<br>No. of Transactions:: 65464","Month:: 7<br>Year: : 2032<br>No. of Transactions:: 69296","Month:: 7<br>Year: : 2033<br>No. of Transactions:: 68756","Month:: 7<br>Year: : 2034<br>No. of Transactions:: 65069"],["Month:: 6<br>Year: : 2028<br>No. of Transactions:: 66806","Month:: 6<br>Year: : 2029<br>No. of Transactions:: 69961","Month:: 6<br>Year: : 2030<br>No. of Transactions:: 72990","Month:: 6<br>Year: : 2031<br>No. of Transactions:: 62310","Month:: 6<br>Year: : 2032<br>No. of Transactions:: 61645","Month:: 6<br>Year: : 2033<br>No. of Transactions:: 65828","Month:: 6<br>Year: : 2034<br>No. of Transactions:: 59874"],["Month:: 5<br>Year: : 2028<br>No. of Transactions:: 66320","Month:: 5<br>Year: : 2029<br>No. of Transactions:: 71252","Month:: 5<br>Year: : 2030<br>No. of Transactions:: 72710","Month:: 5<br>Year: : 2031<br>No. of Transactions:: 64604","Month:: 5<br>Year: : 2032<br>No. of Transactions:: 60793","Month:: 5<br>Year: : 2033<br>No. of Transactions:: 63619","Month:: 5<br>Year: : 2034<br>No. of Transactions:: 59962"],["Month:: 4<br>Year: : 2028<br>No. of Transactions:: 59944","Month:: 4<br>Year: : 2029<br>No. of Transactions:: 67736","Month:: 4<br>Year: : 2030<br>No. of Transactions:: 68325","Month:: 4<br>Year: : 2031<br>No. of Transactions:: 59510","Month:: 4<br>Year: : 2032<br>No. of Transactions:: 59654","Month:: 4<br>Year: : 2033<br>No. of Transactions:: 56483","Month:: 4<br>Year: : 2034<br>No. of Transactions:: 57771"],["Month:: 3<br>Year: : 2028<br>No. of Transactions:: 53412","Month:: 3<br>Year: : 2029<br>No. of Transactions:: 63652","Month:: 3<br>Year: : 2030<br>No. of Transactions:: 78775","Month:: 3<br>Year: : 2031<br>No. of Transactions:: 55773","Month:: 3<br>Year: : 2032<br>No. of Transactions:: 53639","Month:: 3<br>Year: : 2033<br>No. of Transactions:: 52072","Month:: 3<br>Year: : 2034<br>No. of Transactions:: 55030"],["Month:: 2<br>Year: : 2028<br>No. of Transactions:: 62051","Month:: 2<br>Year: : 2029<br>No. of Transactions:: 60940","Month:: 2<br>Year: : 2030<br>No. of Transactions:: 64087","Month:: 2<br>Year: : 2031<br>No. of Transactions:: 62580","Month:: 2<br>Year: : 2032<br>No. of Transactions:: 56742","Month:: 2<br>Year: : 2033<br>No. of Transactions:: 57791","Month:: 2<br>Year: : 2034<br>No. of Transactions:: 58061"],["Month:: 1<br>Year: : 2028<br>No. of Transactions:: 61943","Month:: 1<br>Year: : 2029<br>No. of Transactions:: 72263","Month:: 1<br>Year: : 2030<br>No. of Transactions:: 66766","Month:: 1<br>Year: : 2031<br>No. of Transactions:: 68080","Month:: 1<br>Year: : 2032<br>No. of Transactions:: 60280","Month:: 1<br>Year: : 2033<br>No. of Transactions:: 64710","Month:: 1<br>Year: : 2034<br>No. of Transactions:: 68518"]],"showlegend":false,"hoverinfo":"text","type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"tickfont":{"size":10},"tickangle":45,"tickvals":[1,2,3,4,5,6,7],"ticktext":["2028","2029","2030","2031","2032","2033","2034"],"linecolor":"#ffffff","range":[0.5,7.5],"showticklabels":true,"anchor":"y"},"yaxis":{"domain":[0,1],"automargin":true,"tickfont":{"size":10},"tickangle":0,"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12],"ticktext":["12","11","10","9","8","7","6","5","4","3","2","1"],"linecolor":"#ffffff","range":[0.5,12.5],"showticklabels":true,"title":"Month","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":24,"l":12,"t":30,"r":null},"scene":{"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"title":"Number of Transactions by Year and Month","legend":{"y":1,"yanchor":"top"}},"attrs":{"846b3ba83397":{"z":[[69088,69737,61575,61605,60394,67510,53017],[67989,71067,69048,62353,60699,65661,56243],[66761,76201,76324,64590,62169,73045,54978],[69955,75622,76863,61842,62485,69728,54384],[73039,73370,77035,71300,68459,68785,62945],[70132,71708,72825,65464,69296,68756,65069],[66806,69961,72990,62310,61645,65828,59874],[66320,71252,72710,64604,60793,63619,59962],[59944,67736,68325,59510,59654,56483,57771],[53412,63652,78775,55773,53639,52072,55030],[62051,60940,64087,62580,56742,57791,58061],[61943,72263,66766,68080,60280,64710,68518]],"x":[1,2,3,4,5,6,7],"y":[1,2,3,4,5,6,7,8,9,10,11,12],"text":[["Month:: 12<br>Year: : 2028<br>No. of Transactions:: 69088","Month:: 12<br>Year: : 2029<br>No. of Transactions:: 69737","Month:: 12<br>Year: : 2030<br>No. of Transactions:: 61575","Month:: 12<br>Year: : 2031<br>No. of Transactions:: 61605","Month:: 12<br>Year: : 2032<br>No. of Transactions:: 60394","Month:: 12<br>Year: : 2033<br>No. of Transactions:: 67510","Month:: 12<br>Year: : 2034<br>No. of Transactions:: 53017"],["Month:: 11<br>Year: : 2028<br>No. of Transactions:: 67989","Month:: 11<br>Year: : 2029<br>No. of Transactions:: 71067","Month:: 11<br>Year: : 2030<br>No. of Transactions:: 69048","Month:: 11<br>Year: : 2031<br>No. of Transactions:: 62353","Month:: 11<br>Year: : 2032<br>No. of Transactions:: 60699","Month:: 11<br>Year: : 2033<br>No. of Transactions:: 65661","Month:: 11<br>Year: : 2034<br>No. of Transactions:: 56243"],["Month:: 10<br>Year: : 2028<br>No. of Transactions:: 66761","Month:: 10<br>Year: : 2029<br>No. of Transactions:: 76201","Month:: 10<br>Year: : 2030<br>No. of Transactions:: 76324","Month:: 10<br>Year: : 2031<br>No. of Transactions:: 64590","Month:: 10<br>Year: : 2032<br>No. of Transactions:: 62169","Month:: 10<br>Year: : 2033<br>No. of Transactions:: 73045","Month:: 10<br>Year: : 2034<br>No. of Transactions:: 54978"],["Month:: 9<br>Year: : 2028<br>No. of Transactions:: 69955","Month:: 9<br>Year: : 2029<br>No. of Transactions:: 75622","Month:: 9<br>Year: : 2030<br>No. of Transactions:: 76863","Month:: 9<br>Year: : 2031<br>No. of Transactions:: 61842","Month:: 9<br>Year: : 2032<br>No. of Transactions:: 62485","Month:: 9<br>Year: : 2033<br>No. of Transactions:: 69728","Month:: 9<br>Year: : 2034<br>No. of Transactions:: 54384"],["Month:: 8<br>Year: : 2028<br>No. of Transactions:: 73039","Month:: 8<br>Year: : 2029<br>No. of Transactions:: 73370","Month:: 8<br>Year: : 2030<br>No. of Transactions:: 77035","Month:: 8<br>Year: : 2031<br>No. of Transactions:: 71300","Month:: 8<br>Year: : 2032<br>No. of Transactions:: 68459","Month:: 8<br>Year: : 2033<br>No. of Transactions:: 68785","Month:: 8<br>Year: : 2034<br>No. of Transactions:: 62945"],["Month:: 7<br>Year: : 2028<br>No. of Transactions:: 70132","Month:: 7<br>Year: : 2029<br>No. of Transactions:: 71708","Month:: 7<br>Year: : 2030<br>No. of Transactions:: 72825","Month:: 7<br>Year: : 2031<br>No. of Transactions:: 65464","Month:: 7<br>Year: : 2032<br>No. of Transactions:: 69296","Month:: 7<br>Year: : 2033<br>No. of Transactions:: 68756","Month:: 7<br>Year: : 2034<br>No. of Transactions:: 65069"],["Month:: 6<br>Year: : 2028<br>No. of Transactions:: 66806","Month:: 6<br>Year: : 2029<br>No. of Transactions:: 69961","Month:: 6<br>Year: : 2030<br>No. of Transactions:: 72990","Month:: 6<br>Year: : 2031<br>No. of Transactions:: 62310","Month:: 6<br>Year: : 2032<br>No. of Transactions:: 61645","Month:: 6<br>Year: : 2033<br>No. of Transactions:: 65828","Month:: 6<br>Year: : 2034<br>No. of Transactions:: 59874"],["Month:: 5<br>Year: : 2028<br>No. of Transactions:: 66320","Month:: 5<br>Year: : 2029<br>No. of Transactions:: 71252","Month:: 5<br>Year: : 2030<br>No. of Transactions:: 72710","Month:: 5<br>Year: : 2031<br>No. of Transactions:: 64604","Month:: 5<br>Year: : 2032<br>No. of Transactions:: 60793","Month:: 5<br>Year: : 2033<br>No. of Transactions:: 63619","Month:: 5<br>Year: : 2034<br>No. of Transactions:: 59962"],["Month:: 4<br>Year: : 2028<br>No. of Transactions:: 59944","Month:: 4<br>Year: : 2029<br>No. of Transactions:: 67736","Month:: 4<br>Year: : 2030<br>No. of Transactions:: 68325","Month:: 4<br>Year: : 2031<br>No. of Transactions:: 59510","Month:: 4<br>Year: : 2032<br>No. of Transactions:: 59654","Month:: 4<br>Year: : 2033<br>No. of Transactions:: 56483","Month:: 4<br>Year: : 2034<br>No. of Transactions:: 57771"],["Month:: 3<br>Year: : 2028<br>No. of Transactions:: 53412","Month:: 3<br>Year: : 2029<br>No. of Transactions:: 63652","Month:: 3<br>Year: : 2030<br>No. of Transactions:: 78775","Month:: 3<br>Year: : 2031<br>No. of Transactions:: 55773","Month:: 3<br>Year: : 2032<br>No. of Transactions:: 53639","Month:: 3<br>Year: : 2033<br>No. of Transactions:: 52072","Month:: 3<br>Year: : 2034<br>No. of Transactions:: 55030"],["Month:: 2<br>Year: : 2028<br>No. of Transactions:: 62051","Month:: 2<br>Year: : 2029<br>No. of Transactions:: 60940","Month:: 2<br>Year: : 2030<br>No. of Transactions:: 64087","Month:: 2<br>Year: : 2031<br>No. of Transactions:: 62580","Month:: 2<br>Year: : 2032<br>No. of Transactions:: 56742","Month:: 2<br>Year: : 2033<br>No. of Transactions:: 57791","Month:: 2<br>Year: : 2034<br>No. of Transactions:: 58061"],["Month:: 1<br>Year: : 2028<br>No. of Transactions:: 61943","Month:: 1<br>Year: : 2029<br>No. of Transactions:: 72263","Month:: 1<br>Year: : 2030<br>No. of Transactions:: 66766","Month:: 1<br>Year: : 2031<br>No. of Transactions:: 68080","Month:: 1<br>Year: : 2032<br>No. of Transactions:: 60280","Month:: 1<br>Year: : 2033<br>No. of Transactions:: 64710","Month:: 1<br>Year: : 2034<br>No. of Transactions:: 68518"]],"showlegend":false,"hoverinfo":"text","zmin":null,"zmax":null,"colors":"Blues","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="distribution-of-hscode" class="level1">
<h1>Distribution of HScode</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>MC2_hscode_weight <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hscode,year) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">weight =</span> <span class="fu">n</span>(),</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_weight =</span> <span class="fu">median</span>(weightkg))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">treemap</span>(MC2_hscode_weight,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">index=</span><span class="fu">c</span>(<span class="st">"hscode"</span>,<span class="st">"year"</span>,<span class="st">"median_weight"</span>),</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">vSize=</span><span class="st">"weight"</span>,</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">vColor=</span><span class="st">"median_weight"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span><span class="st">"value"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette=</span><span class="st">"Blues"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">title=</span><span class="st">"Median weight(KG) by hscode"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">title.legend =</span> <span class="st">"Median Weight in KG"</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="data-preparation-for-visnetwork" class="level2">
<h2 class="anchored" data-anchor-id="data-preparation-for-visnetwork">Data Preparation for visNetwork</h2>
<section id="top-30-source-and-top-30-target" class="level3">
<h3 class="anchored" data-anchor-id="top-30-source-and-top-30-target">TOP 30 SOURCE AND TOP 30 TARGET</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filter for top 30 source </span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>MC2_challenge_source <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sourcelabel) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight =</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">30</span>,weight)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co">#filter for top 30 target</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>MC2_challenge_target <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(targetlabel) <span class="sc">%&gt;%</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weight =</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight)) <span class="sc">%&gt;%</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">30</span>,weight)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a><span class="co">#filter edges for transactions in top 30 source and top 30 target </span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>revisedlist <span class="ot">&lt;-</span> MC2_challenge_edges<span class="sc">%&gt;%</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sourcelabel <span class="sc">%in%</span> MC2_challenge_source<span class="sc">$</span>sourcelabel) <span class="sc">%&gt;%</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(targetlabel <span class="sc">%in%</span> MC2_challenge_target<span class="sc">$</span>targetlabel) </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="co">#filter out nodes that are in top 30 source and top 30 target </span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>check_id_vis <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(label <span class="sc">%in%</span> revisedlist<span class="sc">$</span>sourcelabel <span class="sc">|</span> </span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>           label <span class="sc">%in%</span> revisedlist<span class="sc">$</span>targetlabel) <span class="sc">%&gt;%</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">group =</span> rcvcountry)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a><span class="co">#aggregate by weight and rename to ensure that it                                         has id in nodes and from and to column in edges </span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>MC2_agg_rev <span class="ot">&lt;-</span> revisedlist <span class="sc">%&gt;%</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(check_id_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourcelabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(check_id_vis, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetlabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from, to) <span class="sc">%&gt;%</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(from<span class="sc">!=</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(check_id_vis, MC2_agg_rev, <span class="at">main =</span><span class="st">"Top 30 source/targets </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="st">           &lt;br&gt;by receiving country&lt;br&gt;"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">selectedBy=</span><span class="st">"group"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span> <span class="co">#indicate direction </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span>(<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addFontAwesome</span>(<span class="at">name =</span> <span class="st">"font-awesome"</span>) <span class="sc">%&gt;%</span> <span class="co">#add icon to network </span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">shape =</span> <span class="st">"icon"</span>, <span class="at">icon=</span> <span class="fu">list</span>(<span class="at">code =</span><span class="st">"f21a"</span>, <span class="at">color =</span> <span class="st">"#3B9AB2"</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="co">#freeze network</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a978d67e26464c95c9cc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a978d67e26464c95c9cc">{"x":{"nodes":{"id":["5","6","8","9","11","18","19","22","26","37","44","49","52","53","59","82","84","88","94","95","97","133","162","199","206","211","215","218","226","255","268","272","291","307","326","339","364","367","376","379","394","419","449","482","488","538","539","571","581","584","629","858","964","1283","1292","1305","1721","9404"],"label":["Olas del Mar Worldwide","French Crab S.p.A. Worldwide","Panope Limited Liability Company","hǎi dǎn Corporation Wharf","Sea Breezes GmbH & Co. KG Shark","Costa de la Felicidad Shipping","Mar del Este CJSC","Black Sea Tuna Snapper","Sailors and Surfers Incorporated Enterprises","Selous Game Reserve  S.A. de C.V.","Caracola del Sol Services","Saltwater Supreme ОАО Forwading","Océano de Coral Corporation Express","Pao gan SE Seal","Oceanic Explorers Sashimi Inc Solutions","Playa de la Luna Incorporated","Uttarakhand  Market Limited Liability Company Nautical","Portuguese Tuna Incorporated Marine","Caracola Azul Oyj &","Coral Cove BV Delivery","Arunachal Pradesh s Brine","ReefRider Foods Ltd. Corporation Family","Kong zhong diao yu  Ges.m.b.H.","Náutica del Norte Kga Holdings","Ianira Starfish Sagl Import","SeaTree Ltd. Liability Co Holdings","Saltwater Supreme Pelican Ltd Enterprises","Orange River   GmbH & Co. KG Shipping","Zambezi Gorge  N.V. Transport","Chhattisgarh   Marine ecology A/S Delivery","Saltwater Symphony S.A. de C.V.","Pao gan LC Freight ","Mar y Luna Sagl","bǐ mù yú Sagl Distribution","Danish Shrimp Kga Solutions","Rift Valley fishery Inc","suō yú Incorporated Brothers","nián yú Ltd. Corporation","Fresh Limited Liability Company","Marine Masterminds Dry dock","Coastal Cruisers Pic Shipping","Marine Mates Cruise ship","Icelandic Cod Pier ОАО Transport","Arunachal Pradesh s A/S Transport","Uttar Pradesh s CJSC","Olas del Sur Sea","Greek Sea Bass LLC","Selous Game Reserve  A/S","Coastal Castaway Coast Corporation Worldwide","Dry Creek Pic Marine biology","Barents Sea Cod CJSC Export","Saltwater Sisters Inc Seafaring","Estrella del Mar Seafarer","Caracola del Este Corporation Express","Playa del Tesoro BV","Sea Breezes S.A. de C.V. Freight ","Tamil Nadu  Market Co","Fisherman's Bounty AG Solutions"],"trade_status":["Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export"],"shpcountry":["Oceanus","Kondanovia","Vesperanda","Marebak","Oceanus","Alverossia","Merigrad","Puerto Sol","Puerto Sol","Isliandor","Puerto Sol","Puerto Sol","Vesperanda","Alverossia","Oceanus","Kondanovia","Helixia","Oceanus","Playa Solis","Quornova","Nalakond","Oceanus","Oceanus","Merigrad","Rio Isla","Gavanovia","Puerto Sol","Marebak","Marebak","Oceanus","Marebak","-22004","Marebak","Alverossia","Rio Isla","Puerto del Mar","Marebak","Merigrad","Marebak","Marebak","Marebak","Alverossia","Utoporiana","Oceanus","Marebak","Rio Isla","Khamseena","Rio Isla","Alverossia","Vesperanda","Marebak","Alverossia","Oceanus","Oceanus","Kondanovia","Isliandor","Talandria","Marebak"],"group":["Oceanus","Utoporiana","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Anderia del Mar","Sol y Oceana","Oceanus","Oceanus","Oceanus","Marebak","Oceanus","Oceanus","Oceanus","Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Marebak","Coralmarica","Oceanus","Oceanus","Coralmarica","Oceanus","Oceanus","Coralmarica","Oceanus","Oceanus","Oceanus","Oceanus","Marebak","Oceanus","Oceanus","Oceanus","Oceanus","Coralmarica","Oceanus","Luminkind"],"x":[-0.219743339590207,-0.68955003313923,-0.50045270035564,-0.403787498655227,-0.304220919465661,-0.419706842986368,-0.67484380302044,-0.346410958856929,-0.603370276191812,-0.412040656907022,-0.461120121755624,-0.747893731424424,-0.378236290458495,-0.536913653240432,1,-0.492039794341242,-0.816811307284943,-0.746508941192135,-0.784976350994016,-0.57312982421651,-0.736284838135265,-0.188609008970732,-0.651361170343716,-0.443982582470665,-0.499817404236809,-0.361741119173769,-0.300758086301127,-0.552967310495243,-0.617509150346441,-0.0398114224940217,-0.696020925390003,-0.746924282439871,-0.503918301583358,-0.61114491822726,-0.178435689697406,-0.586239546084599,-0.441485652625107,-0.502359941401627,-0.62150830495514,-0.862242946906783,-0.508388340598108,-0.632315920299687,-0.319881969763445,0.346875114494708,-0.510962290911385,-0.7470358605284,-1,-0.378763813711288,-0.290153508740184,-0.515130003622618,-0.550213253043009,-0.286042481445789,-0.557517833363315,-0.671386771674179,-0.365970201428829,-0.831702191492382,-0.199926616514017,-0.446595407415321],"y":[0.0163420446462856,-0.0346944071435968,0.406902040172671,0.258797896449043,0.303835834923656,0.164669630464636,0.324051830541889,-0.180632909785332,0.386777661769773,-0.266622819393614,0.303079608055293,0.129120525088344,0.361029515006152,0.500070246415947,-1,-0.491819706893752,0.369479913070985,-0.576177416524234,-0.149984589278745,0.289036133274044,0.282817678983324,-0.157334198811556,0.522173172866637,-0.00371562341228904,1,-0.412805167301804,0.143629051796233,-0.0958510583784876,0.0335856059509532,-0.377371709391283,0.087062544716096,-0.326207444516385,-0.0319444316903267,-0.177572481483617,0.529963286503025,0.499581519466482,-0.151601917208578,0.810478563608175,-0.0735534225086609,0.582493695801759,-0.168993649944556,-0.638121937571303,0.623709761900037,-0.511568280372422,0.165693853260189,0.466540902982156,-0.330638720295021,0.0339982975974769,-0.0646375881211662,-0.3621865631787,0.0540734073344273,-0.254363735736382,-0.236760159826299,-0.175087543080759,0.538861526523144,0.108283289194207,0.267359500960685,0.55555831726294]},"edges":{"from":["1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1283","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1292","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1305","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","1721","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","199","206","206","206","206","206","206","206","206","206","206","206","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","218","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","226","255","255","255","255","255","255","255","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","268","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","291","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","307","326","326","326","326","326","326","326","326","326","326","326","326","326","326","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","364","367","367","367","367","367","367","367","367","367","367","367","367","367","367","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","376","379","379","379","379","379","379","379","379","379","379","379","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","394","449","449","449","449","449","449","449","449","449","449","449","449","449","449","449","449","482","482","482","482","482","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","488","538","538","538","538","538","538","538","538","538","538","538","538","538","538","538","538","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","571","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","584","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","6","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","629","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","858","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","9404","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964","964"],"to":["133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","82","84","88","9","94","95","97","162","18","19","211","215","22","26","37","44","49","5","52","53","581","8","84","9","95","97","162","18","19","26","272","339","37","44","49","5","53","581","82","9","94","97","133","162","18","19","215","22","26","339","37","44","53","581","82","9","94","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","84","88","9","95","97","11","162","26","339","44","52","53","8","9","95","97","11","133","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","84","88","9","94","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","133","18","37","44","5","82","9","11","162","18","211","22","26","272","339","37","419","44","49","52","53","581","8","84","88","9","94","95","97","11","133","162","18","211","215","22","26","272","339","37","419","44","49","52","53","581","8","82","84","88","9","94","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","11","133","18","215","22","26","339","44","49","5","52","8","9","95","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","53","581","8","82","88","9","94","95","97","162","18","19","215","26","339","44","5","53","581","84","9","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","18","26","44","49","53","8","82","84","9","94","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","5","52","53","539","581","8","88","9","94","95","97","11","133","162","18","19","211","26","339","37","44","49","52","8","84","9","95","133","255","5","581","59","11","133","162","18","19","211","215","22","26","272","339","37","44","49","5","52","53","581","8","82","84","9","94","95","97","11","18","215","22","26","272","339","37","44","49","52","539","8","9","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","9","94","95","97","11","133","18","19","215","26","272","37","44","49","52","581","8","82","88","9","94","95","11","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","539","581","8","82","84","88","9","94","95","97","11","133","162","18","19","211","215","22","26","272","339","37","419","44","49","5","52","53","581","8","82","84","88","9","94","95","97","11","133","18","211","215","22","272","37","44","49","52","581","8","82","9","94","95","97","11","133","18","215","22","26","272","339","37","44","5","53","581","8","84","9","94","95","97","133","162","18","19","211","215","22","255","26","272","339","37","44","49","5","52","53","539","581","82","84","88","9","94","95","97"],"weight":[28,125,406,554,108,1364,689,274,282,282,508,15,3499,154,103,4,190,10,126,908,344,265,15966,43,1336,24,600,7827,18,42,11,11,122,4,558,1135,3,4,4,3,3,50,1759,445,267,940,632,1107,40,2,119,333,9442,179,2,4690,16,20,631,4,158,13984,340,240,1049,2,1751,143,5,86,1458,421,59,2,357,8,1330,2388,51,2675,17,77,3,4,1675,2,612,406,2758,942,5624,4,95,76,3060,5592,2,30,394,4970,6814,3,709,3,4,244,470,564,5,8941,5077,7113,2,8532,1234,1384,3,30,462,24,368,157,21,540,5266,1580,136,5,282,42,32,7187,12,11,195,8648,3952,2605,32,123,84,875,1663,328,688,304,491,792,486,848,1200,58,1567,871,996,435,1178,19,211,696,208,114,244,6154,244,957,153,16,8,3,3,78,2,4,1808,20,4165,9,9,296,32,40,141,2,514,9872,13,286,236,8675,10,92,2273,163,174,40,1734,24,159,5634,54,5,330,1132,198,89,618,2,1441,16547,13,1490,1172,18066,30,50,142,6386,453,566,60,2664,833,213,5619,44,43,91,1197,1765,785,2018,3052,187,371,13025,32,16,795,24,1068,4316,68,101,8,8707,2641,1367,75,95,159,78,92,30,4794,106,83,196,6678,1354,350,89,5,13,217,7,6665,592,2,55,2,1136,2,238,279,4347,2781,65,75,538,31,11,8,7,6665,1138,8,75,468,5989,299,834,2,5,71,91,2703,8,2,117,83,2,287,762,1072,3455,1147,626,957,1192,2415,752,1230,1372,430,2416,3080,1231,416,1531,122,505,1150,350,451,824,10598,1471,3684,672,2635,19,41,47134,8,70,15414,198,873,3,2,461,2914,29,3337,33,118,334,1211,756,4,41,44,10064,23752,3,2889,1970,25,131,538,11,6679,66,227,288,312,21,3816,15,4,3,201,451,2,568,18,329,1354,99,9399,4190,8,19,53,17,2,20846,4309,2,8889,11,23,74,235,551,1584,391,3238,6238,73,153,3137,2729,3871,15103,6,468,11367,215,126,20,42,521,367,65,243,284,53,92,24,197,11,21969,10,408,2,104,739,21,4,1527,44,2,1006,684,173,47,21,11,184,377,690,36,407,1395,3,1954,158,4492,27,150,46,6292,7,542,2,95,16,2265,438,343,512,2,562,13310,13,1301,3454,269,928,111,505,64,54,42,747,703,257,4,8,4484,18,258,35898,15,268,4,25,9,2086,1210,19,4,2052,2,63,1904,480,180,210,449,95,752,184,57,2532,155,153,429,60,848,1943,423,78,221,79,909,8,76,71,2685,283,3912,50,206,7,123,12,50,17,57,18,59,37,7,7,506,3,763,427,3237,17,3284,480,4457,2,234,2,102,409,1086,2619,18,237,4598,2683,142,2320,25,12,5,7,181,70,40,32,15,23,74,105,62,111,12,198,8,210,10,14,3,10,149,12,19,638,4,62,7]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"physics":false,"shape":"icon","icon":{"code":"f21a","color":"#3B9AB2"}},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123},"interaction":{"dragNodes":false,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["Oceanus","Utoporiana","Anderia del Mar","Sol y Oceana","Marebak","Coralmarica","Luminkind"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false,"variable":"group","main":"Select by group","values":["Anderia del Mar","Coralmarica","Luminkind","Marebak","Oceanus","Sol y Oceana","Utoporiana"]},"main":{"text":"Top 30 source/targets \n           <br>by receiving country<br>","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"iconsRedraw":true,"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>top30_snt <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> check_id_vis,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> MC2_agg_rev,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>top30_snt <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weight))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tbl_graph: 58 nodes and 588 edges
#
# A directed acyclic simple graph with 1 component
#
# A tibble: 588 × 3
   from    to weight
  &lt;int&gt; &lt;int&gt;  &lt;int&gt;
1    40    12  47134
2     2    12  35898
3    41    11  23752
4    46    47  21969
5    45     5  20846
6    33     3  18066
# ℹ 582 more rows
#
# A tibble: 58 × 5
  id    label                            trade_status    shpcountry group     
  &lt;chr&gt; &lt;chr&gt;                            &lt;chr&gt;           &lt;chr&gt;      &lt;chr&gt;     
1 5     Olas del Mar Worldwide           Import &amp; Export Oceanus    Oceanus   
2 6     French Crab S.p.A. Worldwide     Import &amp; Export Kondanovia Utoporiana
3 8     Panope Limited Liability Company Import &amp; Export Vesperanda Oceanus   
# ℹ 55 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>snt <span class="ot">&lt;-</span> top30_snt <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">betweenness_centrality =</span> <span class="fu">centrality_betweenness</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fr"</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">width =</span> weight), <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>betweenness_centrality))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>snt <span class="sc">+</span> <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex02_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="filter-unknown-status" class="level2">
<h2 class="anchored" data-anchor-id="filter-unknown-status">filter unknown status</h2>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to filter list of unknown parties </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>unknownMC2_nodes <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trade_status <span class="sc">==</span> <span class="st">"Unknown"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="co">#create df to filter list of exporters who solely do export or both </span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>MC2_exporters <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(trade_status <span class="sc">==</span> <span class="st">"Export"</span> <span class="sc">|</span> trade_status <span class="sc">==</span> <span class="st">"Import &amp; Export"</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="co">#append by matching exporters to the importers (list of unknown)</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>unknownMC2 <span class="ot">&lt;-</span> MC2_challenge_edges <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(MC2_exporters, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sourcelabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(unknownMC2_nodes, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"targetlabel"</span> <span class="ot">=</span> <span class="st">"label"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> id) <span class="sc">%&gt;%</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (<span class="sc">!</span><span class="fu">is.na</span>(to)) <span class="sc">%&gt;%</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from,to) <span class="sc">%&gt;%</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>unknownMC2_revnodes <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> unknownMC2<span class="sc">$</span>from <span class="sc">|</span> id <span class="sc">%in%</span> unknownMC2<span class="sc">$</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> trade_status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Incorporate icons for node sharps from Font Awesome. Add in <code>addFontAwesome()</code> function and modify the shape and icon arguments to <code>VisNodes()</code>. Moreover, custom navigation have been included with the feature to zoomView, dragView.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create network diagram for exporters</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(unknownMC2_revnodes, unknownMC2, </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Exporters who ship to &lt;br&gt; Unknown Origin&lt;br&gt;"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span> (<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span> <span class="co">#indicate direction </span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addFontAwesome</span>(<span class="at">name =</span> <span class="st">"font-awesome"</span>) <span class="sc">%&gt;%</span> <span class="co">#add icon to network </span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fill color and shape</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Unknown"</span>, <span class="at">shape =</span> <span class="st">"icon"</span>, </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">icon=</span> <span class="fu">list</span>(<span class="at">code =</span><span class="st">"f21a"</span>, <span class="at">color =</span> <span class="st">"#E1AF00"</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visGroups</span>(<span class="at">groupname =</span> <span class="st">"Import &amp; Export"</span>, <span class="at">shape =</span> <span class="st">"icon"</span>, </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">icon=</span> <span class="fu">list</span>(<span class="at">code =</span><span class="st">"f21a"</span>, <span class="at">color =</span> <span class="st">"#3B9AB2"</span> )) <span class="sc">%&gt;%</span> </span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, </span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="co">#freeze network</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-3526ec53d0d1fcd86560" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3526ec53d0d1fcd86560">{"x":{"nodes":{"id":["1","2","9","19","20","24","26","37","49","61","63","67","68","69","70","89","90","91","93","95","99","122","124","131","138","143","149","158","171"],"label":["AquaDelight Inc and Son's","BaringoAmerica Marine Ges.m.b.H.","hǎi dǎn Corporation Wharf","Mar del Este CJSC","8.Marine United AG","SeaBass &  SE Tanker","Sailors and Surfers Incorporated Enterprises","Selous Game Reserve  S.A. de C.V.","Saltwater Supreme ОАО Forwading","ArawakFish Cargo Ges.m.b.H.","Punjab s Marine conservation","Kong zhong diao yu  A/S","Dry CreekWorldLogistics Ltd. Liability Co","-1515","Arunachal Pradesh s SRL","HomabayMarine Carriers N.V.","Selkie Ltd. Liability Co","lú yú GmbH & Co. KG","KambalaSea Freight  Inc","Coral Cove BV Delivery","Maacama Ocean Worldwide LLC","OranjestadCreek Express Sagl","-214","SamakaDredgeTransport OJSC","Fisherman's Best Marine conservation","SavanetaCreek Solutions NV","SouthSeafood Express Corp","StichtingMarine Shipping Company","SumacAmerica Transport GmbH & Co. KG"],"group":["Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Import & Export","Unknown","Import & Export","Unknown","Unknown","Import & Export","Unknown","Import & Export","Unknown","Unknown","Unknown","Unknown"],"x":[0.415962123994069,0.572298096241585,0.0724004663969087,0.893761837764786,0.703993543442584,-0.705373511480151,0.447710874311129,-0.236514054277596,-0.274435111516714,-0.912439707621718,-1,-0.484105871227321,-0.535626098408012,-0.787846115964409,-0.621742146197511,-0.258282200870673,-0.345589424340269,-0.534520197245947,0.909873179648514,1,0.0932736419605902,0.35575457743798,0.573412327354523,0.912313415810659,-0.0744693440820864,0.291362458566213,-0.109774314674664,0.126061710382834,0.313276967664509],"y":[0.730344295980457,0.865688723128206,-0.611457619993889,0.278905145828587,0.106124558779374,-0.228663217540298,-0.020777768964237,-0.120292908930891,0.526608744249069,-0.269083169115553,-0.0517479654836444,0.835379463102555,0.577959979688913,0.59889301247148,0.32888264269814,-0.756635490101273,-1,-0.723964662174811,-0.486767393184236,-0.286470733993258,-0.913500889748362,-0.744569916633974,-0.853327411585791,0.511724079609606,1,-0.314529681620327,-0.35737041874254,0.994972512041544,0.217580871932064]},"edges":{"from":["1","124","138","19","19","24","26","26","26","37","49","63","67","69","70","9","9","9","9","9","90","91","95"],"to":["2","122","158","131","20","61","143","171","20","149","68","61","68","68","68","122","143","149","89","99","89","89","93"],"weight":[2,2,2,2,2,2,2,2,2,2,4,2,4,4,4,3,2,2,2,2,2,2,2]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123},"groups":{"Unknown":{"shape":"icon","icon":{"code":"f21a","color":"#E1AF00"}},"useDefaultGroups":true,"Import & Export":{"shape":"icon","icon":{"code":"f21a","color":"#3B9AB2"}}},"interaction":{"dragNodes":false,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["Import & Export","Unknown"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Exporters who ship to <br> Unknown Origin<br>","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"iconsRedraw":true,"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Based on the network above, there are 3 companies who supply to more than 1 unknown organization.</p>
<p>~Hai Dan Corporation Wharf (deliver to 5 Unknown Status) ~Sailors and Surfers Incorporated Enterprises (deliver to 3 Unknown Status) ~Mar del Este CJSC (deliver to 3 Unknown Status )</p>
</section>
</section>
<section id="filter-for-companies-with-duplicated-entries" class="level1">
<h1>filter for companies with duplicated entries</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#detect duplicate rows and aggregate it </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>MC2_dup_rows <span class="ot">&lt;-</span> MC2_challenge_edges[<span class="fu">duplicated</span>(MC2_challenge_edges),] <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">from =</span> source) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">to =</span> target) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from,to) <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weight =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (weight <span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>MC2_dup_top10 <span class="ot">&lt;-</span> MC2_dup_rows <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">10</span>,weight) </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">#create df with corresponding nodes </span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>MC2_dup_nodes <span class="ot">&lt;-</span> MC2_id_list_vis <span class="sc">%&gt;%</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> MC2_dup_top10<span class="sc">$</span>from <span class="sc">|</span> id <span class="sc">%in%</span> MC2_dup_top10<span class="sc">$</span>to) <span class="sc">%&gt;%</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">group =</span> trade_status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are approximately 32% duplicated rows in the trade data.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create network diagram for exporters</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(MC2_dup_nodes, MC2_dup_top10, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">main =</span> <span class="st">"Trade Transactions with  &lt;br&gt; Top 10 duplicates &lt;br&gt;"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visIgraphLayout</span>(<span class="at">layout =</span> <span class="st">"layout_with_fr"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">nodesIdSelection =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLayout</span> (<span class="at">randomSeed =</span> <span class="dv">123</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visEdges</span>(<span class="at">arrows =</span> <span class="st">"to"</span>) <span class="sc">%&gt;%</span> <span class="co">#indicate direction </span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addFontAwesome</span>(<span class="at">name =</span> <span class="st">"font-awesome"</span>) <span class="sc">%&gt;%</span> <span class="co">#add icon to network </span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#fill color and shape</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visLegend</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visInteraction</span>(<span class="at">dragNodes =</span> <span class="cn">FALSE</span>, <span class="at">dragView =</span> <span class="cn">TRUE</span>, </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">zoomView =</span> <span class="cn">TRUE</span>, <span class="at">navigationButtons =</span> <span class="cn">TRUE</span>) <span class="co">#freeze network</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0a95dfb80a25900e71f5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0a95dfb80a25900e71f5">{"x":{"nodes":{"id":["6","49","59","77","82","95","141","255","379","449","895","1281","1283","2065","14880"],"label":["French Crab S.p.A. Worldwide","Saltwater Supreme ОАО Forwading","Oceanic Explorers Sashimi Inc Solutions","Himachal Pradesh   Plc International","Playa de la Luna Incorporated","Coral Cove BV Delivery","Belgian Shrimps Ocean Corp Holdings","Chhattisgarh   Marine ecology A/S Delivery","Marine Masterminds Dry dock","Icelandic Cod Pier ОАО Transport","Isla del Tesoro GmbH & Co. KG Chart","Isla del Mar Marine Oyj Transit","Caracola del Este Corporation Express","-2119","Himachal Pradesh   S.A. de C.V. America"],"group":["Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import & Export","Import","Import & Export"],"x":[-0.8145588975035,-0.562734749719203,0.789559363454469,0.673735128510497,0.0159905528159239,0.24613480186362,-1,-0.03201236312474,-0.279201637845933,-0.0418821328824406,0.840060155388607,1,-0.635574949202303,-0.807132737429145,0.590854227526444],"y":[0.360075461078866,0.619832826955851,-0.738271226056868,-0.110707417184396,1,-1,0.0716909833269463,-0.102797769133637,0.839939704259653,-0.893818602739442,0.56579036417392,-0.103264804159461,-0.809863534173615,-0.54156545337469,0.76018743969143]},"edges":{"from":["1281","1283","14880","255","379","379","449","59","6","6"],"to":["77","2065","895","255","49","82","95","59","141","49"],"weight":[5174,2277,3048,2652,20406,4502,1540,3041,9929,9272]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false,"arrows":"to"},"physics":{"stabilization":false},"layout":{"randomSeed":123},"interaction":{"dragNodes":false,"dragView":true,"navigationButtons":true,"zoomView":true,"zoomSpeed":1}},"groups":["Import & Export","Import"],"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Trade Transactions with  <br> Top 10 duplicates <br>","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","igraphlayout":{"type":"square"},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"iconsRedraw":true,"legend":{"width":0.2,"useGroups":true,"position":"left","ncol":1,"stepX":100,"stepY":100,"zoom":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#check for duplicates </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>dup <span class="ot">&lt;-</span> (<span class="fu">nrow</span>(MC2_challenge_edges) <span class="sc">-</span> <span class="fu">nrow</span>(<span class="fu">unique</span>(MC2_challenge_edges)))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#reformat output </span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>dup_reformat <span class="ot">&lt;-</span> <span class="fu">format</span>(dup, <span class="at">big.mark=</span><span class="st">","</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#print output</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>dup_reformat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "155,291"</code></pre>
</div>
</div>
</section>
<section id="references" class="level1">
<h1>References:</h1>
<p>https://vast-challenge.github.io/2023/MC2.html</p>
<p>https://www.nagraj.net/notes/visnetwork/</p>
<p>https://cran.r-project.org/web/packages/visNetwork/vignettes/Introduction-to-visNetwork.html</p>
<p>https://jtr13.github.io/cc21fall2/network-visualization-in-r.html</p>
<p>https://r-graph-gallery.com/38-rcolorbrewers-palettes.html</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../Take-Home_Ex/Take_Home_Ex01/Take-Home_Ex01.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Take Home Exercise 1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>